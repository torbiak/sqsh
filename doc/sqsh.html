<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>sqsh</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>



<h1 id="NAME">NAME</h1>

<p>sqsh - Interactive database shell (version 2.5)</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code>       sqsh [[options]] [[args......]]
            [ -a count ]
            [ -A packet_size ]
            [ -b ]
            [ -B ]
            [ -c [cmdend] ]
            [ -C sql ]
            [ -d severity ]
            [ -D database ]
            [ -e ]
            [ -E editor ]
            [ -f severity ]
            [ -G tds_version ]
            [ -h ]
            [ -H hostname ]
            [ -i filename ]
            [ -I interfaces ]
            [ -J charset ]
            [ -k keywords ]
            [ -K keytab]
            [ -l debug_flags ]
            [ -L var=value ]
            [ -m style ]
            [ -n on|off ]
            [ -N appname ]
            [ -o filename ]
            [ -p ]
            [ -P [password] ]
            [ -Q query_timeout ]
            [ -r [sqshrc] ]
            [ -R server principal ]
            [ -s colsep ]
            [ -S server ]
            [ -t [filter] ]
            [ -T login_timeout ]
            [ -U username ]
            [ -v ]
            [ -V [bcdimoqru]]
            [ -w width ]
            [ -X ]
            [ -y directory ]
            [ -z language ]
            [ -Z [secmech|default|none] ]</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Sqsh (pronounced skwish) is short for SQshelL (pronounced s-q-shell), and is intended as a replacement for the venerable &#39;isql&#39; program supplied by Sybase. It came about due to years of frustration of trying to do real work with a program that was never meant to perform real work.</p>

<p>Sqsh is much more than a nice prompt, it is intended to provide much of the functionality provided by a good shell, such as variables, aliasing, redirection, pipes, back-grounding, job control, history, command substitution, and dynamic configuration. Also, as a by-product of the design, it is remarkably easy to extend and add functionality.</p>

<h1 id="OPTIONS">OPTIONS</h1>

<p>The following options may be used to adjust some of the behavior of sqsh, however a large portion of the configuration options are available only through environment variables which may be set at runtime or via a .sqshrc file.</p>

<p>Options may also be supplied in the SQSH environment variable. This variable is parsed prior to parsing the command line, so in most cases the command line will override the contents of the variable. Be aware that for options which are allowed to be supplied multiple times, such as <b>-c</b>, supplying them both in a variable and on the command line will be the same as supplying them multiple times on the command line.</p>

<dl>

<dt id="a-count">-a count</dt>
<dd>

<p>Sets the maximum <i>count</i> of failures (as determined by the <b>$thresh_fail</b> variable) that may occur before sqsh will abort. Setting this to 0 indicates that sqsh should not exit on errors. This value defaults to 0 and may also be set using the <b>$thresh_exit</b> variable. See section <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="A-packetsize">-A packetsize</dt>
<dd>

<p>Specifies the size of the network TDS packets used to communicate with the SQL server. This value must be between 512 and 8192, and be a multiple of 512. Check your SQL Server configuration to determine supported packet sizes. This value may also be specified at run-time using the <b>$packet_size</b> variable.</p>

</dd>
<dt id="b">-b</dt>
<dd>

<p>Suppress the banner message upon startup. This is unnecessary in cases where stdout has been redirected to a file. This option may also be set via the <b>$banner</b> variable.</p>

</dd>
<dt id="B">-B</dt>
<dd>

<p>Turns off all buffering of stdin, stdout, and stderr. This feature allows sqsh to be run from an interactive control script such as chat and expect.</p>

</dd>
<dt id="c-cmdend">-c [cmdend]</dt>
<dd>

<p>Internally sqsh provides the command <b>\go</b> to send a batch of SQL to the database and provides a single alias, <b>go</b> for this command. Each time <i>cmdend</i> is supplied a new alias for <b>\go</b> is established.</p>

</dd>
<dt id="C-sql">-C sql</dt>
<dd>

<p>Causes the <i>sql</i> command to be executed by sqsh, similar to the same behavior exhibited by the -i flag. This <i>sql</i> statement may not contain double quotes (this limitation may be lifted in a future release of sqsh).</p>

</dd>
<dt id="d-severity">-d severity</dt>
<dd>

<p>Sets the minimum SQL Server error severity that will be displayed to the user. The default is 0, and valid ranges are from 0 to 22. This may also be set using the <b>$thresh_display</b> variable. See section <b>EXIT STATUS</b>.</p>

</dd>
<dt id="D-database">-D database</dt>
<dd>

<p>Causes sqsh to attempt to start with your database context set to <i>database</i> rather than your default database (usually master). This may also be set using the <b>$database</b> variable.</p>

</dd>
<dt id="e">-e</dt>
<dd>

<p>Includes each command issued to sqsh to be included in the output. This option may also be set via the <b>$echo</b> variable (which is unrelated to the <b>\echo</b> command).</p>

</dd>
<dt id="E-editor">-E editor</dt>
<dd>

<p>Set the default editor to <i>editor</i>. This may also be set using the UNIX environment variable <b>$EDITOR</b> to the name of the editor desired.</p>

</dd>
<dt id="f-severity">-f severity</dt>
<dd>

<p>Sets the minimum <i>severity</i> level considered a failure by sqsh. This is the same as setting the <b>$thresh_fail</b> variable. See section <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="G-tds_version">-G tds_version</dt>
<dd>

<p>Set the TDS version to use. Valid versions are 4.0, 4.2, 4.6, 4.9.5, 5.0 and freetds additionally supports versions 7.0 and 8.0. The specified value is assigned to the variable <b>$tds_version</b>. Input validation is not performed by sqsh. However, when an invalid TDS version is specified, the default version of 5.0 will be used. After a session is setup, the variable <b>$tds_version</b> will be set to the TDS version in effect. The variable will not be available if option -G is not used. Meant for test and debugging purposes only.</p>

<p>TDS stands for Tabular Data Stream and is the communication protocol Sybase and Microsoft uses for Client-Server communication.</p>

</dd>
<dt id="h">-h</dt>
<dd>

<p>Turns off column headers and trailing &quot;(# rows affected)&quot; from batch output.</p>

</dd>
<dt id="H-hostname">-H hostname</dt>
<dd>

<p>Sets the client hostname as reported in sysprocesses. This may also be set via the <b>$hostname</b> variable.</p>

</dd>
<dt id="i-filename">-i filename</dt>
<dd>

<p>Read all input from <i>filename</i> rather than from stdin.</p>

</dd>
<dt id="I-interfaces">-I interfaces</dt>
<dd>

<p>When a connection is established to the database, the <i>interfaces</i> file is used to turn the value of <b>$DSQUERY</b> into the hostname and port to which the connection will be made, by default this is located in <b>$SYBASE</b>/interfaces. This flag allows this default to be overridden.</p>

</dd>
<dt id="J-charset">-J charset</dt>
<dd>

<p>Specifies the character set to be used on the client side to communicate with SQL Server. This may also be set using the <b>$charset</b> environment variable.</p>

</dd>
<dt id="k-keywords">-k keywords</dt>
<dd>

<p>Specifies a file containing a list of keywords to be used for keyword tab completion, if readline support has been compiled into sqsh. This file may also be set via the <b>$keyword_file</b> variable, which defaults to <b>$HOME</b>/.sqsh_words.</p>

</dd>
<dt id="K-keytab">-K keytab</dt>
<dd>

<p>Kerberos support. Specify the keytab file name for DCE.</p>

<p>See the Kerberos Support section below for details.</p>

</dd>
<dt id="l-debug_flags">-l debug_flags</dt>
<dd>

<p>If sqsh has been compiled with -DDEBUG, this option may be used to turn on and off debugging options. See the <b>$debug</b> variable, below.</p>

</dd>
<dt id="L-var-value">-L var=value</dt>
<dd>

<p>Sets the value of <b>$var</b> to <i>value</i>. This may be used to set the value of any sqsh variable even if an explicit command line variable is supplied for setting the variable. The <b>-L</b> flag may be used to set the value of non-configuration variables as well.</p>

</dd>
<dt id="m-style">-m style</dt>
<dd>

<p>Changes the current display style to <i>style</i>. Currently supported styles are <b>horiz</b>, <b>vert</b>, <b>bcp</b>, <b>csv</b>, <b>html</b>, <b>meta</b>, <b>pretty</b> and <b>none</b>. The current display style may also be set using the <b>$style</b> variable or via the <b>-m</b> flag to the <b>\go</b> command.</p>

</dd>
<dt id="n-on-off">-n on|off</dt>
<dd>

<p>Enables chained transaction mode on connect (if set to on). Chained transaction mode is also known as &quot;AutoCommit off&quot; mode.</p>

</dd>
<dt id="N-appname">-N appname</dt>
<dd>

<p>Set the application name sqsh uses to identify itself to the SQL server. The application name can be retrieved from the server using the column <b>program_name</b> of the master.dbo.sysprocesses table. Defaults to <i>sqsh-2.1.7</i>.</p>

</dd>
<dt id="o-filename">-o filename</dt>
<dd>

<p>Redirects all output to <i>filename</i> rather than stdout.</p>

</dd>
<dt id="p">-p</dt>
<dd>

<p>Display performance statistics upon completion of every SQL batch. This option may also be turned on via the <b>$statistics</b> variable, or by supplying the <b>-p</b> flag to the <b>\go</b> command.</p>

</dd>
<dt id="P-password">-P [password | -]</dt>
<dd>

<p>The Sybase <i>password</i> for <i>username</i> required to connect to <i>server</i> (default, NULL). The <i>password</i> may also be set via <b>$password</b>. Supplying a password of &#39;-&#39; causes the password to be read from the first line of stdin.</p>

<p>sqsh takes pains to hide the password from any user trying to view the command line used to launch sqsh, so using <b>-P</b> should not constitute a security hole. Alternatively, you can store your default password in .sqshrc file which is not readable by anyone other than yourself. (chmod 600 .sqshrc)</p>

</dd>
<dt id="Q-value">-Q value</dt>
<dd>

<p>Query timeout value (equivalent to isql&#39;s -t option). If set, will timeout a long running query. Maps to the <b>$query_timeout</b> variable.</p>

<p>For example:</p>

<pre><code>    sqsh -SASE1502 -Usa -P -Q30
    ASE1502.sa.master.1&gt; cd tix
    ASE1502.sa.tix.1&gt; select count(*) from E_TIX;
    Open Client Message
    Layer 1, Origin 2, Severity 2, Number 63
    ct_results(): user api layer: internal Client Library error:
                Read from the server has timed out.
    ASE1502: Query or command timeout detected, command/batch cancelled
    ASE1502: The client connection has detected this 1 time(s).</code></pre>

<p>See also the <b>$max_timeout</b> variable, which controls the number of times a timeout may occur on the current connection before the session is aborted.</p>

</dd>
<dt id="r-sqshrc">-r [sqshrc]</dt>
<dd>

<p>Specifies an alternate <i>.sqshrc</i> file to be processed, rather than the default. If no <i>sqshrc</i> is supplied following <b>-r</b>, then no initialization files are processed. This flag <b>must</b> be the first argument supplied on the command line, all other instances will be ignored.</p>

</dd>
<dt id="R-server_principal">-R server_principal</dt>
<dd>

<p>Kerberos support: Specifies a <i>server principal</i> to use for network (Kerberos) authentication, if the server name in the interfaces file differs from the real server name.</p>

<p>See the Kerberos Support section below for details.</p>

</dd>
<dt id="s-colsep">-s colsep</dt>
<dd>

<p>Causes the string <i>colsep</i> to be used to delimit SQL column output columns, this defaults to &quot; &quot;.</p>

</dd>
<dt id="S-server-host:port-:filter">-S server | host:port[:filter]</dt>
<dd>

<p>The name or the address of the Sybase <i>server</i> to connect. The default of this is the external environment variable <b>$DSQUERY</b>. If neither <b>-S</b> nor <b>$DSQUERY</b> is set then defaults to &quot;SYBASE&quot;. This value may also be set via the internal variable <b>$DSQUERY</b>. The servername must exist in the interfaces or sql.ini file. As an alternative it is also possible to specify the target server as <b>host:port[:filter]</b> where <i>host</i> may also be an IP address. Note that <b>filter</b> may be defined in $SYBASE/$SYBASE_OCS/config/libtcl[64].cfg. For example:</p>

<pre><code>    [FILTERS]
    ssl=libsybfssl.so
    ssl64=libsybfssl64.so</code></pre>

</dd>
<dt id="t-filter">-t [filter]</dt>
<dd>

<p>Enables filtering of command batches through an external program, <i>filter</i>, and prior to being sent to the SQL Server. If <i>filter</i> is not supplied, then <b>$filter_prog</b> is used (default is &#39;m4 -&#39;). This value may also be set via the <b>$filter</b> and <b>$filter_prog</b> variables.</p>

</dd>
<dt id="T-value">-T value</dt>
<dd>

<p>Specifies the login timeout (similar to isql&#39;s -l flag). If set specifies the number of seconds <i>sqsh</i> will wait before timing out a login request. Maps to the <b>$login_timeout</b> variable.</p>

</dd>
<dt id="U-username">-U username</dt>
<dd>

<p>The Sybase <i>username</i> to connect to the database as, this defaults to the username of the user running <i>sqsh</i>. The <i>username</i> may also be set via the <b>$username</b> variable.</p>

</dd>
<dt id="v">-v</dt>
<dd>

<p>Displays the version number, <b>$version</b>, and exits.</p>

</dd>
<dt id="V-bcdimoqru">-V [bcdimoqru]</dt>
<dd>

<p>Kerberos support: Specify the security options to use.</p>

<p>See the Kerberos Support section below for details.</p>

</dd>
<dt id="w-width">-w width</dt>
<dd>

<p>The maximum output <i>width</i> of a displayed result set, this defaults to your screen width in interactive mode.</p>

</dd>
<dt id="X">-X</dt>
<dd>

<p>Initiates the login connection to the server with client-side password encryption (if supported). If either SQL Server does not recognize this option, or if the version of CT-Lib used to compile <i>sqsh</i> does not support this option, then it will be ignored. This option may also be set using the <b>$encryption</b> environment variable.</p>

</dd>
<dt id="y-directory">-y directory</dt>
<dd>

<p>Specifies a SYBASE <i>directory</i> to use other than the value of <b>$SYBASE</b> in order to find the interfaces file.</p>

</dd>
<dt id="z-language">-z language</dt>
<dd>

<p>Specifies an alternate <i>language</i> to display sqsh prompts and messages. Without the <b>-z</b> flag, the server&#39;s default language will be used. This may also be set using the <b>$language</b> variable.</p>

</dd>
<dt id="Z-secmech-default-none">-Z [secmech|default|none]</dt>
<dd>

<p>Kerberos support: Specify the security mechanism to use.</p>

<p>See the Kerberos Support section below for details.</p>

</dd>
<dt id="args">args...</dt>
<dd>

<p>If sqsh is run with the <b>-i</b> flag specifying an input file to be processed (rather than initiating an interactive session), arguments may be supplied on the command line to be passed to the input file. These arguments may be accessed using the variables ${0}, ${1}, ... (see the <b>Variables</b> section, below, for more information).</p>

</dd>
</dl>

<h2 id="Initialization">Initialization</h2>

<p>Upon startup, sqsh initializes all internal environment variables, commands, and aliases to their default values, it then looks in the system-wide configuration file (usually /usr/local/etc/sqshrc), followed by a local configuration file <b>$HOME</b>/.sqshrc (this may be overridden via the SQSHRC external environment variable). If this file is found it is executed just like a script would be using the <b>-i</b> flag.</p>

<p>The <i>.sqshrc</i> file may contain anything that could normally be typed at the prompt, however it should be noted that at the time this file is read sqsh has yet to establish a connection to the database, however most commands that perform database activity, such as <b>\go</b> will attempt to establish a database connection when executed (it may also prompt you for a password if necessary). Also, if database activity is required within this startup file, the <b>\connect</b> command (see <b>COMMANDS</b>, below) may be executed.</p>

<p>After the <i>.sqshrc</i> file has been executed, <i>sqsh</i> then parses any command line options (thus any variables set in your <i>.sqshrc</i> file may be overridden by command line options). Following that, if <i>sqsh</i> is run in interactive mode (i.e. without <b>-i</b> and if stdin is attached to a tty), it then looks for the file provided by the <b>$history</b> variable and loads the contents of that file into the history buffers. (see <b>BUFFERS</b>, below).</p>

<p>Immediately prior to establishing a connection to the database (either during startup, or by an explicit <b>\connect</b> or <b>\reconnect</b> command), the file <b>$HOME</b>/.sqsh_session is executed. The name of this file may be overridden using the <b>$session</b> variable.</p>

<h2 id="Command-line">Command line</h2>

<p>When a line is first read by <i>sqsh</i>, the first word is separated from the line. This word is then expanded of all variables (see <b>Variable Substitution</b>, below), followed by command expansion (see <b>Command Substitution</b>, below). The first word of the resulting string is then analyzed to see if it is either a valid <i>sqsh</i> command or alias.</p>

<p>The <i>sqsh</i> command line follows many of the same rules as Bourne shell, allowing file redirection, pipelining, command substitution, and back-grounding via the same syntax.</p>

<h2 id="Comments">Comments</h2>

<p>Any line beginning with a <b>#</b> followed by a non-alphanumeric character (any character other than 0-9, a-z, A-Z, and _) causes the entire line to be ignored. Because of the possible collision with T-SQL session specific temp-table names, the line will not be ignored if the first character following the <b>#</b>, is alphanumeric.</p>

<h2 id="Quoting">Quoting</h2>

<p>Quoting is used to prevent the interpretation of special keywords or characters to sqsh, such as white-space, variable expansion, or command substitution. There are three types of quoting, <i>escape</i>, <i>single-quotes</i>, and <i>double-quotes</i>.</p>

<p>Enclosing characters in single quotes preserves the literal interpretation of each character contained within the quotes. A single quote may not appear within single quotes, even when preceded by an escape. For example:</p>

<pre><code>    1&gt; \echo I can not expand &#39;$username&#39;</code></pre>

<p>outputs</p>

<pre><code>    I can not expand $username</code></pre>

<p>The characters \\ are used to escape the meaning (and thus prevent the interpretation) of the character immediately following them. The \ character itself may be escaped. For example:</p>

<pre><code>    1&gt; \echo I can\\&#39;t expand &#39;$username&#39;</code></pre>

<p>outputs</p>

<pre><code>    I can&#39;t expand $username</code></pre>

<p>The escape character may also be used to escape a new-line in order to perform a line continuation, in this case the new-line is discarded and the continued line is automatically appended to the previous line, for example:</p>

<pre><code>    1&gt; \echo Hello \\
    --&gt; World!
    Hello World!</code></pre>

<p>Enclosing characters in double quotes preserves the literal meaning of all characters within them with the exception of <b>$</b>, <b>&#39;</b>, and <b>\\</b>. A double quote may be contained within double quotes by escaping it.</p>

<pre><code>    1&gt; \echo &quot;\\&quot;I can&#39;t deny it, I like $username\\&quot;, she said&quot;</code></pre>

<p>prints out</p>

<pre><code>    &quot;I can&#39;t deny it, I like gray&quot;, she said</code></pre>

<h2 id="Expansion">Expansion</h2>

<p>After a line of input has been read, <i>sqsh</i> attempts to expand the line of any aliases (see <b>Aliasing</b>, below), following that it attempts to determine if the line begins with a command keyword. Once a line has been determined to contain a command name it has three types of expansion performed to it: <i>variable substitution</i>, followed by <i>command substitution</i> respectively. Finally, if a tilde was provided on the command line, then <i>tilde expansion</i> will be performed and the <b>~</b> will be substituted with the corresponding <b>HOME</b> directory name.</p>

<pre><code>    1&gt; \echo ~sybase/err.log</code></pre>

<p>may result in <i>/home/sybase/err.log</i> for example.</p>

<pre><code>    1&gt; exec sp_helpdb
    2&gt; go &gt; ~/db.log</code></pre>

<p>may result in a file <i>/export/home/dba/db.log</i> for example, depending on the Unix login and the exact OS you are using. Following this expansion the command line is separated into words and the command is executed.</p>

<h2 id="Variable-Substitution">Variable Substitution</h2>

<p>The character $ is used to indicate variable substitution or expansion within a word. These variables may be assigned values by the <b>\set</b> command like so:</p>

<pre><code>    1&gt; \set name=value</code></pre>

<p><i>name</i> may be a character or underscore followed by any combination of characters, digits, or underscore, and may not contain any special characters, such as (&#39;) and (&quot;). The restriction on the first character being a digit is introduced because SQL allows the representation of money data types as $nn.nn where n is a digit.</p>

<p><i>value</i> may contain anything, however if it is to include white-space, then it must be quoted (see <b>Words &amp; Quoting</b>, above). Note that in order to prevent the expansion of a variable use either single quotes, or two \&#39;s, like thus:</p>

<pre><code>    1&gt; \echo \\$name
    $name</code></pre>

<p>Variables may be referenced in one of two ways:</p>

<p>$variable In this manner all characters, digits, and underscores are treated as the <i>name</i> of the variable until another type of character is reached (either a special character, or a white-space). ${variable} The braces are required only when <i>variable</i> is followed by a letter, digit, or underscore that is not to be interpreted as part of its name. Note that the same effect may be achieved using double quotes.</p>

<p>It should be noted that because the variables are expanded prior to breaking the command line into words, if the contents of the variable contain white spaces, they are treated as significant by the parser. In the following example:</p>

<pre><code>    1&gt; \set x=&quot;1 2 3&quot;
    1&gt; \echo $x</code></pre>

<p>the <b>\echo</b> command receives three arguments, &quot;1&quot;, &quot;2&quot;, and &quot;3&quot;, although it looks as if only one argument was passed to it. This behavior is consistent with most shells (such as csh, bourne shell, etc.).</p>

<h2 id="Command-Substitution">Command Substitution</h2>

<p><i>Sqsh</i> supports a second form of expansion called <i>command substitution</i>. This form of expansion substitutes a command on the command line with the output of the external UNIX command. This expansion may be achieved by placing the command line to be executed in back-quotes (`). For example:</p>

<pre><code>    1&gt; \set password=`/sybase/bin/getpwd $DSQUERY`
    1&gt; \echo $password
    ilikepickles</code></pre>

<p>This example, the external program <b>/sybase/bin/getpwd</b> is executed with the current contents of the <b>$DSQUERY</b> environment variable, the entire expression is then replaced with the output of <b>getpwd (ilikepickles)</b> prior to executing the <b>\set</b> command. By default, the output of the substituted command is first broken into words according to the contents of the <b>$ifs</b> variable prior to assembling together back into the command line. So, by overriding the contents of <b>$ifs</b> you may affect the behavior of the substitution process.</p>

<p>For example:</p>

<pre><code>    1&gt; \set ifs=&quot;:&quot;
    1&gt; \echo `echo hello:how:are:you`
    hello how are you</code></pre>

<p>This mechanism is frequently useful for parsing input files, such as <b>/etc/passwd</b> into fields.</p>

<h2 id="Input-Output-Redirection">Input/Output Redirection</h2>

<p>As with standard Bourne shell (and most other shells, for that matter), a command&#39;s input and output may be redirected using a special notation interpreted by the shell. The following may appear anywhere on the command line, but only redirection that is specified <i>prior</i> to a pipe (|) actually has any effect on the behavior of internal sqsh commands (refer to <b>Pipes</b>, below).</p>

<dl>

<dt id="word">&lt;word</dt>
<dd>

<p>Use the file <i>word</i> as the standard input for the command. Typically very few <i>sqsh</i> commands actually read anything from stdin, so this will usually have no effect (see the <b>\loop</b> command).</p>

</dd>
<dt id="n-word">[n]&gt;word</dt>
<dd>

<p>Associate the output of file descriptor <i>n</i> (stdout, by default) with file <i>word</i>. If this file does not exist it is created; otherwise it is truncated to zero length.</p>

</dd>
<dt id="n-word1">[n]&gt;&gt;word</dt>
<dd>

<p>Append the output of file descriptor <i>n</i> (stdout, by default) to file <i>word</i>, creating it if it does not exist.</p>

</dd>
<dt id="m-n">[m]&gt;&amp;n</dt>
<dd>

<p>Redirect the output of file descriptor <i>m</i> (stdout by default), to same output as file descriptor <i>n</i>. The order in which redirections are specified on the command line is significant, as the redirections are evaluated left-to-right. For example:</p>

<pre><code>    1&gt; select * from select /* syntax error */
    2&gt; \go &gt;/tmp/output 2&gt;&amp;1</code></pre>

<p>This statement first redirects the standard output of the <b>\go</b> command to the file <i>/tmp/output</i>, then redirects the stderr to the same file. So, when the commands fails, the error output will be found in the file <i>/tmp/output</i>.</p>

<p>However, by changing the order of redirection, you can completely change the meaning:</p>

<pre><code>    1&gt; select * from select
    2&gt; \go 2&gt;&amp;1 &gt;/tmp/output
    Msg 156, Level 15, State 1
    Server &#39;SQSH_TEST&#39;, Line 1
    Incorrect syntax near the keyword &#39;select&#39;.</code></pre>

<p>In this case, error output will be sent to stdout, while what would have gone to stdout is redirected to <i>/tmp/output</i> (in this case <i>/tmp/output</i> will be empty).</p>

</dd>
</dl>

<p>Please read the section on <b>Background Jobs</b>, below, for detailed info on the interaction between file redirection and background jobs.</p>

<h2 id="Pipes">Pipes</h2>

<p>A <i>pipeline</i> is a sequence of one or more commands separated by a &#39;|&#39;, each command using the stdout of the preceding program for its own stdin. However the first command in the <i>pipeline</i> must be a sqsh command, and all other commands must be external (or UNIX) programs. Any sqsh command may be run through a pipeline, although for many of them (such as the <b>\set</b> command) it doesn&#39;t really make any sense to do this. The following is an example of a <i>pipeline</i>:</p>

<pre><code>    1&gt; select * from syslogins
    2&gt; \go | more</code></pre>

<p>This command causes the result set generated by the <b>\go</b> command to be sent to the <b>more(1)</b> program, which then sends it to your screen, pausing at each screen full of data (this is the primary reason that I wrote sqsh).</p>

<p>There are several peculiarities in the way in which sqsh deals with <i>pipelines</i> as opposed to the way in which standard Bourne shell treats them.</p>

<p>Everything following the first occurrence of a pipe (|) character is broken into white-space delimited words, including such special shell commands as &#39;2&gt;&amp;1&#39; and other occurrences of pipes. If there are any variables contained in these words they are expanded following the same quoting rules as described in <b>Words &amp; Quoting</b>, above, with the one exception that all quotes are left in place. These words are then reassembled into a single string and shipped off to /bin/sh for processing.</p>

<p>In short, sqsh makes no attempt to interpret what follows the first pipe, instead it is shipped off to a &quot;real&quot; shell to do the work. The rationale behind this is that I was lazy and didn&#39;t feel like writing all of the same bizarre variable handling, &amp;&amp;&#39;ing, ||&#39;ing, grouping, and variable expansion rules that Bourne shell supports, and instead I let Bourne do the dirty work.</p>

<p>The advantage of this method is that you can do some very complex stuff after the pipeline, such as:</p>

<pre><code>    1&gt; select * from syscolumns
    2&gt; \go | (cd /tmp; compress -c &gt; sysolumns.Z)</code></pre>

<p>Not that I can think of any real reason to do this...but you can if you want to.</p>

<h2 id="Background-Jobs">Background Jobs</h2>

<p>Backgrounding provides a mechanism whereby you may run any sqsh command as a background process and continue working while it runs. Sqsh offers two types of backgrounding:</p>

<dl>

<dt id="Deferred">Deferred</dt>
<dd>

<p>In this mode sqsh redirects all output of the background job to a temporary file (located in the directory <b>$tmp_dir</b>) while the job is running, so that the output is not intermixed with what you are currently working on. When the job completes you are notified of the process completion and the output may be viewed using the <b>\show</b> command.</p>

</dd>
<dt id="Non-Deferred">Non-Deferred</dt>
<dd>

<p>This corresponds to the common idea of a background process under UNIX. In this mode the output of the job is not implicitly redirected for you, and thus may become intermingled with what you are currently working. The mode selection you choose is selectable via the <b>$defer_bg</b> variable (which defaults to &#39;1&#39;, or &#39;On&#39;). Typically the only reason to not use <i>deferred</i> mode is to prevent large result sets from filling up your file system.</p>

</dd>
</dl>

<p>To specify that a job be run in the background, simply append a &amp; to the end of the command line, as:</p>

<pre><code>    1&gt; sp_long_arduous_proc 1, 30
    2&gt; \go &amp;
    Job #1 running [xxxx]
    1&gt;</code></pre>

<p>When sqsh encounters the &amp; on the end of the command line it spawns a child process (with a Unix process id of <i>xxxx</i>) then the child process calls the <b>\go</b>. <b>\go</b> command then establishes a new connection to the database (using the current values of the <b>$DSQUERY</b>, <b>$username</b>, <b>$password</b> variables) and executes the shown query. While the job is executing the commands <b>\jobs</b>, <b>\wait</b> and <b>\kill</b> may be used to monitor or alter a currently running job (see section <b>COMMANDS</b>, below). When any job completes sqsh will display a notification, such as:</p>

<pre><code>    1&gt; select count(*) from &lt;return&gt;
    Job #1 complete (output pending)
    2&gt;</code></pre>

<p>When a job completes, if it had no output, it is immediately considered terminated and will not show up in the current list of running jobs. However if the complete job has pending output, it will continue to be displayed as a running job (with the <b>\jobs</b> command) until a <b>\show</b> is used to display the output of the job. When you exit your parent sqsh session and there are background jobs active then a message is shown: <b>You have running jobs or pending job output</b>. You have to process all the jobs first before being able to exit sqsh.</p>

<p>There is a known bug with job backgrounding when used in conjunction with pipes, please refer to the <b>BUGS</b> section at the end of the manual.</p>

<h2 id="Buffers">Buffers</h2>

<p>In normal <b>isql</b> only two buffers are maintained; the buffer into which you are currently typing, and a buffer that contains the last batch executed (this is kept around for when you run &#39;vi&#39;, or &#39;edit&#39;).</p>

<p>Sqsh maintains several distinct sets of buffers:</p>

<p><b>Work Buffer</b>: This buffer corresponds directly to the <b>isql</b> work buffer. It is the buffer into which you enter the current batch prior to sending it to the database.</p>

<p><b>History Buffer</b>: This is actually a chain of 0 or more buffers (configurable by the <b>$histsize</b> variable) of the last <b>$histsize</b> batches that have been run. This buffer is only maintained when sqsh is run in interactive mode; that is, batches executed using the <b>-i</b> flag, or executed via redirection from the UNIX prompt will not be maintained in history (after all, they are already in a file somewhere).</p>

<p>If the variable <b>$histsave</b> is True (see section <b>SPECIAL VARIABLES</b>) and sqsh is in interactive mode, then the current history buffer is written to <b>$HOME</b>/.sqsh_history when you exit. This file is then read back into sqsh the next time it is started in interactive mode.</p>

<p><b>Named Buffers</b>: At any time during a session the <b>Work Buffer</b>, or any of the <b>History Buffers</b> may be copied into a named buffer using the <b>\buf-copy</b> command (see section <b>COMMANDS</b>, below). These buffers are lost when you exit (however you may use the <b>\buf-save</b> command to save named buffers to a file).</p>

<h3 id="Buffer-Short-Hand">Buffer Short-Hand</h3>

<p>Many commands allow all of these buffers to be referenced in a short-hand fashion, very similar to the way that <b>csh(1)</b> references its commands history. Any of these shorthands may be used for any <i>buffer</i> parameter described in the <b>COMMANDS</b> section:</p>

<dl>

<dt id="pod">!.</dt>
<dd>

<p>The current work buffer.</p>

</dd>
<dt id="pod1">!!</dt>
<dd>

<p>The last command executed (note, this is not available in non-interactive mode as it does not maintain a history).</p>

</dd>
<dt id="pod2">!+</dt>
<dd>

<p>The next available history entry. This is a write-only buffer, so typically only applies to such commands as <b>\buf-copy</b>.</p>

</dd>
<dt id="n">!n</dt>
<dd>

<p>Refers to history #n. Each time an entry is written to history it is assigned an increasing number from the last entry, with this short-hand you may reference any given history.</p>

</dd>
<dt id="buf_name">!buf_name</dt>
<dd>

<p>Just for consistency this is supplied as a reference to named buffer <i>buf_name</i>, however <i>buf_name</i> without the leading &#39;!&#39; is also considered correct.</p>

</dd>
<dt id="buf_name1">buf_name</dt>
<dd>

<p>Refers to the named buffer <i>buf_name</i>.</p>

</dd>
</dl>

<h3 id="Variables">Variables</h3>

<p>Variables may also be contained within work buffers. Under these circumstances the variables remain unexpanded until the buffer is sent to the database (via the <b>\go</b> command), during which time they are expanded and replaced within the buffer. This behavior may be altered via the <b>$expand</b> variable. (see <b>Special Variables</b>, below).</p>

<p>The following is an example of using variables within a buffer:</p>

<pre><code>    1&gt; \set table_name=syscolumns
    1&gt; select count(*) from $table_name
    2&gt; \go</code></pre>

<p>This is the equivalent of performing the query:</p>

<pre><code>    1&gt; select count(*) from syscolumns
    2&gt; \go</code></pre>

<p>directly. Typically this feature is useful for reusing large complex <b>where</b> clauses, or long column names.</p>

<p>Quoting rules apply the same in SQL buffers as they do in command lines. That is, any variables contained within double quotes (&quot;) are expanded and variables contained within single quotes (&#39;) are left untouched. Thus:</p>

<pre><code>    1&gt; select &quot;$username&quot;, &#39;$username&#39;
    2&gt; \go</code></pre>

<p>yields the results</p>

<pre><code>    ---- ---------
    gray $username</code></pre>

<h3 id="Command-Substitution1">Command Substitution</h3>

<p>As with the command line, the output of UNIX commands may also be substituted within a SQL buffer upon execution (once again, only if the <b>$expand</b> variable is set to 1, or true). In this circumstance the command contained within back quotes (`) is replaced with its output prior to forwarding the buffer to SQL server. For example:</p>

<pre><code>    1&gt; select count(*) from `echo syscolumns`
    2&gt; \go</code></pre>

<p>Causes the strings &#39;echo syscolumns&#39; to be replaced by the word <i>syscolumns</i> prior to executing the command. It should be noted that the contents of the substituted command are only executed at the time of the <b>\go</b> command, not when the line of SQL is input.</p>

<h2 id="Flow-of-Control">Flow-of-Control</h2>

<p>New with version 2.0 of sqsh, is the ability to perform basic flow-of-control and functions using the <b>\if</b>, <b>\while</b>, <b>\do</b>, and <b>\func</b> commands.</p>

<h3 id="Blocks-SQL-Buffers">Blocks &amp; SQL Buffers</h3>

<p>All sqsh flow-of-control commands are block-based. That is, if the test expression of the command is met, then a block of sqsh-script will be executed. For example, the definition of the <b>\if</b> command is:</p>

<pre><code>    \if expression
        block
    \fi</code></pre>

<p>This <i>block</i> may be any number of lines of sqsh commands, SQL, or flow-of-control statements to be executed if the <i>expression</i> evaluates to a success condition (0).</p>

<p>Each <i>block</i> has its own SQL buffer for the duration that the <i>block</i> is executed. That is, the following statements:</p>

<pre><code>    1&gt; /*
    2&gt; ** IMPROPER USAGE OF IF BLOCK
    3&gt; */
    4&gt; select count(*) from
    5&gt; \if [ $x -gt 10 ]
    6&gt;     sysobjects
    7&gt; \else
    8&gt;     sysindexes
    9&gt; \fi
    5&gt; go</code></pre>

<p>will yield:</p>

<pre><code>    Msg 102, Level 15, State 1
    Server &#39;bps_pro&#39;, Line 1
    Incorrect syntax near &#39;from&#39;</code></pre>

<p>because the string &#39;sysobjects&#39; or &#39;sysindexes&#39; were inserted into their own SQL buffers. These buffers are discarded as soon as the end of the block was reached, and since a <b>\go</b> command was not contained within the block, no additional errors were generated.</p>

<p>Thus, the correct way to write the above expression would be:</p>

<pre><code>    1&gt; /*
    2&gt; ** PROPER USAGE OF IF BLOCK
    3&gt; */
    4&gt;  \if [ $x -gt 10 ]
    5&gt;     select count(*) from sysobjects
    6&gt;     go
    7&gt; \else
    8&gt;     select count(*) from sysindexes
    9&gt;     go
    10&gt; \fi</code></pre>

<p>or, even:</p>

<pre><code>    1&gt; /*
    2&gt; ** PROPER USAGE OF IF BLOCK
    3&gt; */
    4&gt;  \if [ $x -gt 10 ]
    5&gt;     \set table_name=sysobjects
    6&gt; \else
    7&gt;     \set table_name=sysindexes
    8&gt; \fi
    4&gt; select * from $table_name
    5&gt; go</code></pre>

<p>Also, note that the line number displayed in the sqsh prompt resets to the current position in the outer SQL buffer after reaching the <b>\fi</b> terminator.</p>

<h3 id="Expressions">Expressions</h3>

<p>All flow-of-control statements in sqsh take an <i>expression</i> to determine which <i>block</i> of code to execute. Just like UNIX&#39;s Bourne Shell, this <i>expression</i> is simply an operating system program that is executed by sqsh. If the command returns a success status (calls exit(0)), then it is considered successful.</p>

<p>For example, with following statement:</p>

<pre><code>    \while test $x -lt 10
        block
    \done</code></pre>

<p>will execute the contents of <i>block</i> while the current value of $x is less than 10. Note that &#39;test&#39; is a standard UNIX program to perform basic string or numeric comparisons (among other things). Also, unlike many shells, sqsh has no built-in version of &#39;test&#39;.</p>

<p>Sqsh does, however, support the standard short form of &#39;test&#39;:</p>

<pre><code>    \while [ $x -lt 10 ]
        block
    \done</code></pre>

<p>With this expression the open brace (&#39;[&#39;) is replaced by the sqsh parser with &#39;test&#39;, and the close brace (&#39;]&#39;) is discarded.</p>

<h3 id="Unsupported-Expressions">Unsupported Expressions</h3>

<p>Currently sqsh does not support the standard shell predicate operators &#39;&amp;&amp;&#39; and &#39;||&#39;. These can be performed like so:</p>

<pre><code>    \if sh -c &quot;cmd1 &amp;&amp; cmd2&quot;
        block
    \done</code></pre>

<h4 id="if-statement">\if statement</h4>

<p>The <b>\if</b> command performs conditional execution of a sqsh <i>block</i> based upon the outcome of a supplied expression:</p>

<pre><code>    \if expr1
        block1
    \elif expr2
        block2
    \else
        block3
    \fi</code></pre>

<p>In this example, if expression <i>expr1</i> evaluates to true, then the block <i>block1</i> is evaluated. Otherwise, if the expression <i>expr2</i> evaluates to true, then block <i>block2</i> is evaluated. Finally, if all other tests fail <i>block3</i> is evaluated.</p>

<p>Note that, unlike Bourne Shell, every <b>\if</b> command must be accompanies by a trailing <b>\fi</b> statement. Also the sqsh parser is not terribly intelligent: The <b>\else</b> and <b>\fi</b> statements must be the only contents on the line in which they appear, and they may not be aliased to another name.</p>

<h4 id="while-statement">\while statement</h4>

<p>The <b>\while</b> command executes a <i>block</i> of sqsh code for the while a supplied expression remains true.</p>

<pre><code>    \while expr
        block
    \done</code></pre>

<p>In this example, while the expression <i>expr</i> evaluates to true, then the block <i>block</i> is evaluated.</p>

<p>The <b>\break</b> statement may be used to break out of the inner-most <b>\while</b> or <b>\for</b> loop (more on <b>\for</b> below).</p>

<h4 id="for-statement">\for statement</h4>

<p>The <b>\for</b> command executes a <i>block</i> of sqsh code for each <i>word</i> supplied:</p>

<pre><code>    \for var in word ...
        block
    \done</code></pre>

<p>For each <i>word</i> supplied, the value of the variable <b>$var</b> is set to the word and the <i>block</i> of code is executed. Execution ends when there are no more words in the list.</p>

<p>As with <b>\while</b> the <b>\break</b> statement may be used to break out of the inner-most execution loop.</p>

<h4 id="do-command">\do command</h4>

<p>The <b>\do</b> command is kind of a cross between a statement and a command.</p>

<p>It is a form of <b>\go</b> (see below for details on the <b>\go</b> command) in which a <i>block</i> of sqsh code may be executed for each row of data returned from the query. When the <i>block</i> is executed, special sqsh variables #[0-9]+ (a hash followed by a number) may be used to reference the values in the returned query. For example the following command:</p>

<pre><code>    select dbid, name from master..sysdatabases
    \do
        \echo &quot;Checkpointing database #2, dbid #1&quot;
        use #2
        go
        checkpoint
        go
    \done</code></pre>

<p>would cause a CHECKPOINT command to be issued in each database on the server.</p>

<h4 id="Command-line-options">Command line options</h4>

<p>The <b>\do</b> command establishes a new connection to be used by the <i>block</i> of code when executed. By default, this connection is established to the current server (the current setting of <b>$DSQUERY</b>), using the current username (<b>$username</b>) and the current password (<b>$password</b>). This behavior may, however, be overridden using command line options:</p>

<dl>

<dt id="D-database1">-D database</dt>
<dd>

<p>Establishes the connection to the database as the supplied <i>database</i>.</p>

</dd>
<dt id="U-username1">-U username</dt>
<dd>

<p>Establishes the connection to the server as the supplied <i>username</i>.</p>

</dd>
<dt id="P-password1">-P password</dt>
<dd>

<p>Establishes the connection to the server using the supplied <i>password</i> (which is hopefully a valid password for the supplied <i>username</i>).</p>

</dd>
<dt id="S-server-host:port-:filter1">-S server | host:port[:filter]</dt>
<dd>

<p>Establishes the connection to the supplied <i>server</i>.</p>

</dd>
<dt id="n1">-n</dt>
<dd>

<p>Do not create a connection for use by the <b>\do</b> loop. This flag is mutually exclusive with the above flags. With this flag enabled, attempts to perform database commands within the <i>block</i> will generate a flurry of CT-Library errors.</p>

</dd>
</dl>

<h4 id="Column-variables">Column variables</h4>

<p>As mentioned above, the values of the columns in the current result set may be determined using the special #[0-9]+ variables. Thus, the variable #1 would contain the value of column number one of the current result set, and #122 could contain the value of the 122&#39;nd column (column numbers begin at 1).</p>

<p>In the case of nested <b>\do</b> loops, values in previous nesting levels may be referred to by simply appending an addition &#39;#&#39; for each previous nesting level, like so:</p>

<pre><code>    select id, name from sysobjects
    \do
        select name, indid from sysindexes where id = #1
        \do
            \echo &quot;Table ##2 (objid ##1) has index #1&quot;
        \done
    \done</code></pre>

<p>obviously, this isn&#39;t the way you would do this query in real life, but you get the idea.</p>

<p>When expanding columns with NULL values, the column variable will expand to an empty string (&#39;&#39;). Also, references to non-existent columns, such as #0, will result in an empty string (&#39;&#39;).</p>

<p>As with regular sqsh variables (those referenced with a &#39;$&#39;), column variables will not be expanded when contained within single quotes.</p>

<h4 id="Aborting">Aborting</h4>

<p>If the <b>\break</b> or <b>\return</b> commands are issued during the processing of a <b>\do</b> loop, the current query will be canceled, the connection used by the loop will be closed (unless the <b>-n</b> flag was supplied) and the <b>\do</b> loop will abort.</p>

<h4 id="func-command">\func command</h4>

<p>The <b>\func</b> command is used to define a reusable block of sqsh code as a function. Functions are defined like so:</p>

<pre><code>    \func stats
        \if [ $# -ne 1 ]
            \echo &quot;use: stats [on | off]&quot;
            \return 1
        \fi
        set statistics io ${1}
        set statistics time ${1}
        go
    \done</code></pre>

<p>In this example a new function is established called <i>stats</i> that expects a single argument, either &quot;on&quot; or &quot;off&quot;. Using this argument, <i>stats</i> will enable or disable time-based and I/O-based statistics.</p>

<p>Once established, the function may be called like so:</p>

<pre><code>    \call stats on</code></pre>

<p>Causing all instances of ${1} to be replaced with the first command line argument to <i>stats</i>.</p>

<h4 id="Command-line-options1">Command line options</h4>

<p>Currently only one command line argument is available to the <b>\func</b> command.</p>

<dl>

<dt id="x">-x</dt>
<dd>

<p>Causes the function to be exported as a <i>sqsh</i> command. That is, the function may be invoked directly without requiring the <b>\call</b> command. This behavior is optional because command names can potentially conflict with T-SQL keywords. When using this flag it is recommended that you prepend a backslash (\) to your function name.</p>

</dd>
</dl>

<h4 id="Function-variables">Function variables</h4>

<p>As shown in the example above, several special variables are available for use within the body of the function. These are:</p>

<dl>

<dt id="pod3">$#</dt>
<dd>

<p>Expands to the number of arguments supplied to the function or script when invoked.</p>

</dd>
<dt id="pod4">$*</dt>
<dd>

<p>Expands to the complete list of arguments supplied to the function or script when invoked.</p>

</dd>
<dt id="N">${0}..${N}</dt>
<dd>

<p>Expands to positional arguments to the function. ${0} is the name of the function or the script file being invoked, ${1} is the first argument, ${2} the second and so-on, up to argument <i>N</i>. Note that, unlike most shells, sqsh requires that function arguments be referred to using the special curly brace syntax (${1}, rather than $1). The reason for this is that $1 is a valid MONEY value and using the curly braces gets rid of this ambiguity.</p>

</dd>
<dt id="pod5">$?</dt>
<dd>

<p>After the invocation of a function, this will contain its return value (see below).</p>

</dd>
</dl>

<h4 id="Return-value">Return value</h4>

<p>A value may be returned from a function via the <b>\return</b> command.</p>

<p>Like so:</p>

<pre><code>    \return N</code></pre>

<p>Where <i>N</i> is a positive value. This return value is available to the caller of the function via the <b>$?</b> variable. As convention, a return value of 0 is used to indicate a success.</p>

<p>If <b>\return</b> is not explicitly called, the default return value is the current value of the <b>$?</b> variable (which is set to 0 upon entry of the function). Thus, if any SQL statements are invoked within the function, the default return value of <b>$?</b> will be the last error code returned during the processing of the SQL statement.</p>

<h2 id="Kerberos-Support">Kerberos Support</h2>

<p>Starting with version 2.1.6, <i>sqsh</i> provides the same command line options as <i>isql</i> to handle Kerberos network authentication.</p>

<p>In version 2.1.5 experimental Kerberos support was added using the -K and -R options. -K was merely a switch to set Kerberos on. In sqsh 2.1.6 a more advanced implementation of network authentication is introduced, although still experimental.</p>

<p>By using the parameters -K, -R, -V, -Z you can make use of your defined network security settings (libtcl.cfg). The named options are identical to the ones defined for <i>isql</i>.</p>

<dl>

<dt id="K-keytab_file">-K keytab_file</dt>
<dd>

<p>Keytab_file name for DCE.</p>

</dd>
<dt id="R-server_principal1">-R server_principal</dt>
<dd>

<p>Server principal name when servername specified in interfaces differs from the real server name.</p>

</dd>
<dt id="V-bcdimoqru1">-V [bcdimoqru]</dt>
<dd>

<p>Specify security options to use with the security mechanism. Each character stands for a specific security service.</p>

</dd>
<dt id="Z-secmech-default-none1">-Z [secmech|default|none]</dt>
<dd>

<p>Request a security mechanism defined for Kerberos, DCE or PAM in your libtcl.cfg file. Use <b>secmech</b> to specify the name of a SECURITY entry or <b>default</b> for the first available entry in libtcl.cfg. <b>None</b> must be specified to disable network authentication or reset possible existing values in variables <b>$secmech</b> or <b>$secure_options</b>.</p>

</dd>
</dl>

<p>For example, connecting to a server using Kerberos (which happens to be the default, i.e. first entry in libtcl.cfg [SECURITY] tab in this example):</p>

<pre><code>    ~$ sqsh -SSYB1502 -Uuser1 -RFC6A1502 -Z
    \connect: Network authenticated session expires at:
            16 Feb 2010 15:28:39 (11764 secs)
    SYB1502.user1.master.1&gt; select @@servername,@@authmech,
                                 show_sec_services();
    ----------------  -----------  ----------------------------------
    FC6A1502          kerberos     unifiedlogin delegation mutualauth
                                 integrity confidentiality
                                 detectreplay detectseq</code></pre>

<p>Note that the real name of the server (@@servername) differs from the server name in the interfaces file, so we have to specify the principal name through the <b>-R</b> parameter. When you do not specify the <b>-V</b> parameter together with <b>-Z</b>, all available security options will be enabled. When <b>-V</b> is specified without any security service options, only option <b>u</b> for Network Authentication will be implicitly set and the default security mechanism will be used if <b>-Z</b> is not specified.</p>

<pre><code>    [user1@linux-fc6a ~]$ sqsh -SFC6A1502 -Uuser1 -V
    Open Client Message
    Layer 7, Origin 9, Severity 5, Number 1
    ct_connect(): security service layer: internal security control
                layer error:
                Security service provider internal error -1765328352
                occurred.
    [user1@linux-fc6a ~]$ kinit
    Password for user1@LOCALDOMAIN:
    [user1@linux-fc6a ~]$ sqsh -SFC6A1502 -Uuser1 -V
    \connect: Network authenticated session expires at:
            16 Feb 2010 15:28:39 (10964 secs)
    FC6A1502.user1.master.1&gt;</code></pre>

<p>When the connection succeeds, <i>sqsh</i> will store the real name of the security mechanism in the variable <b>$secmech</b>. For example: &quot;\echo $secmech&quot; may show <i>csfkrb5</i>. The parameter <b>-V</b> takes a list of characters from the possible values of <i>bcdimoqru</i>. The option <b>u</b> enables Network Authentication, is the default and will allways be set when using <b>-V</b> or <b>-Z</b>, specified or not.</p>

<pre><code>    b - chanbinding     : Channel binding
    c - confidentiality : Data confidentiality service
    d - delegation      : Allow delegated credentials
    i - integrity       : Data integrity service
    m - mutualauth      : Mutual authentication for connection
                          establishment
    o - dataorigin      : Data origin stamping service
    q - detectseq       : Out-of-sequence detection
    r - detectreplay    : Data replay detection
    u - unifiedlogin    : Network Authentication</code></pre>

<p>Please check master.dbo.syssecmechs for available services. Non-existing or not supported services supplied with <b>-V</b> are silently ignored. If you specify <b>-V</b> and/or <b>-Z</b>, <i>sqsh</i> assumes network authentication is tried and no password is required.</p>

<p>If you have a network authenticated connection and want to \reconnect using normal ASE authentication with username and password, you have to reset the network authentication variables by specifying -Znone</p>

<p>For example:</p>

<pre><code>    [user1@linux-fc6a ~]$ sqsh -SFC6A1502 -Uuser1 -V
    \connect: Network authenticated session expires at:
            16 Feb 2010 15:28:39 (10764 secs)
    FC6A1502.user1.master.1&gt; \echo $secmech csfkrb5
    FC6A1502.user1.master.1&gt; \reconnect -SASE1502 -Usa -Psybase
    Open Client Message
    Layer 7, Origin 9, Severity 5, Number 8
    ct_connect(): security service layer: internal security control
                layer error:
    Consistency checks performed on the credential failed
    (minor status 0).
    FC6A1502.user1.master.1&gt; \reconnect -SASE1502 -Usa -Psybase -Znone
    ASE1502.sa.master.1&gt;</code></pre>

<p>The first \reconnect fails because sqsh still wants to try network authentication. However, no user principal for &#39;sa&#39; exists and no ticket is set and thus the connection fails. The second <b>\reconnect</b> succeeds as the -Znone option reset appropriate variables. If the Kerberos ticket is renewed with <b>kinit</b> or any other client tool, the <i>sqsh</i> session must perform a <b>\reconnect</b> to refresh the credentials and to prevent a premature session abort. With the command <b>\snace</b> you can request for the session expiration interval. Depending on the security services that are set, the database connection may be closed without warning as soon as the ticket expires.</p>

<p>See chapter 16 &quot;External Authentication&quot; from the Sybase System Administration Guide volume 1 for more information on Kerberos network authenticationi, e.a.</p>

<h1 id="COMMANDS">COMMANDS</h1>

<h2 id="Read-Eval-Print">Read-Eval-Print</h2>

<p>The read-eval-print loop is the heart of the sqsh system and is responsible for prompting a user for input and determining what should be done with it. Typically this loop is for internal use only, however they are open to the user because there are some creative things that can be done with them.</p>

<dl>

<dt id="loop--i--n--e-sql-file">\loop [-i] [-n] [-e sql] [file]</dt>
<dd>

<p>The <b>\loop</b> command reads input either from a file, a supplied SQL statement, or from a user (see the options below), determining whether the current line is a portion of a T-SQL statement or a sqsh command, and performing the appropriate action. When run in an interactive mode <b>\loop</b> is also responsible for displaying the current prompt (see <b>$prompt</b> below).</p>

<p><b>\loop</b> completes when all input has been depleted (end-of-file is encountered) or when a command, such as <b>\exit</b> requests that <b>\loop</b> exit.</p>

<dl>

<dt id="i">-i</dt>
<dd>

<p>Normally, if <i>file</i> is supplied and does not exist, <b>\loop</b> will return with an error condition, usually causing sqsh to exit. By supplying the <b>-i</b> flag, control will be returned to the calling loop as if end-of-file had been reached (that is, with no error condition).</p>

</dd>
<dt id="n2">-n</dt>
<dd>

<p>By default, <b>\loop</b> will automatically attempt to connect to the database if a connection has not already been established via the <b>\connect</b> command. The <b>-n</b> flag disables this behavior allowing <b>\loop</b> to process commands that do not require database support.</p>

</dd>
<dt id="e-sql">-e sql</dt>
<dd>

<p>Causes <b>\loop</b> to process the contents of <i>sql</i> as if the user had typed it at the prompt and an implicit call to <b>\go</b> is automatically appended to the statement. If multiple instances of <b>-e</b> are supplied, they are all sent as a single batch to the SQL Server for processing. This option may not be used in combination with a <i>file</i> name as well.</p>

</dd>
<dt id="file">file</dt>
<dd>

<p>Specifies the name of a <i>file</i> to be used as input rather than reading input from the user or from the <b>-e</b> flag.</p>

</dd>
</dl>

</dd>
</dl>

<h3 id="Database-Access">Database Access</h3>

<p>Given the size and complexity of sqsh (just look at the length of this man page), it is amazing how few database manipulation commands that there actually are. The following are commands that affect or use the current database connection:</p>

<dl>

<dt id="connect--A-packet-size--c--D-db--G-tds-version--S-srv--U-user--P-pass--I-ifile--J-charset--K-keytab--R-server_principal--n--N-appname--Q-query_timeout--T-login_timeout--V-bcdimoqru--X--z-language--Z-secmech-default-none">\connect [-A packet size] [-c] [-D db] [-G tds version} [-S srv] [-U user] [-P pass] [-I ifile] [-J charset] [-K keytab] [-R server_principal] [-n] [-N appname] [-Q query_timeout] [-T login_timeout] [-V [bcdimoqru]] [-X] [-z language] [-Z [secmech|default|none]]</dt>
<dd>

<p>This command is used primarily for internal use to establish a connection to a database. If a connection is already established it has no effect, however if a connection has not been established and <b>$password</b> has not been supplied, then the password is requested and a connection is established. <b>\connect</b> accepts the following parameters:</p>

<dl>

<dt id="A">-A</dt>
<dd>

<p>Specifies the size of the network TDS packets used to communicate with the SQL server. This value must be between 512 and 8192, and be a multiple of 512. Check your SQL Server configuration to determine supported packet sizes. This value may also be specified at run-time using the $packet_size variable.</p>

</dd>
<dt id="c">-c</dt>
<dd>

<p>By default, the <b>\connect</b> command uses the contents of <b>$database</b> to determine the database context that should be used upon establishing the connection (this is used by <b>\reconnect</b> to preserve the current database context upon reconnection). The <b>-c</b> flag suppresses this behavior and the default database context of login is used instead.</p>

</dd>
<dt id="D-db">-D db</dt>
<dd>

<p>Causes <b>\connect</b> to attempt to automatically switch the database context to <i>db</i> after establishing the connection.</p>

<p>Using this flag is identical to setting the <b>$database</b> variable prior to establishing the connection.</p>

</dd>
<dt id="G-tds-version">-G tds version</dt>
<dd>

<p>Set the TDS version to use. See the global startup parameter -G for more information on TDS version.</p>

</dd>
<dt id="S-srv-host:port-:filter">-S srv | host:port[:filter]</dt>
<dd>

<p>The name or address of the Sybase <i>server</i> to connect, this defaults to <b>$DSQUERY</b> if not supplied.</p>

</dd>
<dt id="U-user">-U user</dt>
<dd>

<p>The Sybase <i>user</i> to connect to the database as, this defaults to <b>$username</b> variable if not supplied.</p>

</dd>
<dt id="P-pass">-P pass</dt>
<dd>

<p>The <i>password</i> for <i>user</i> required to connect to <i>server</i>. This defaults to <b>$password</b> if not supplied.</p>

</dd>
<dt id="I-ifile">-I ifile</dt>
<dd>

<p>The full path of an alternate Sybase <i>interfaces</i> file to use.</p>

</dd>
<dt id="J-charset1">-J charset</dt>
<dd>

<p>The name of the client character set to communicate with the server.</p>

</dd>
<dt id="K-keytab_file1">-K keytab_file</dt>
<dd>

<p>Used for DCE user authentication.</p>

</dd>
<dt id="R-principal_name">-R principal_name</dt>
<dd>

<p>Use for Kerberos user authentication to specify the name of the server principal when the name differs from the <b>$DSQUERY</b> value.</p>

<p>See also the discussion on Kerberos support.</p>

</dd>
<dt id="n3">-n</dt>
<dd>

<p>Specifies that the connection must use ANSI compliant chained mode.</p>

</dd>
<dt id="N-appname1">-N appname</dt>
<dd>

<p>Specify the application name the server will use for program_name in the sysprocesses table.</p>

</dd>
<dt id="Q-query_timeout">-Q query_timeout</dt>
<dd>

<p>Set a query timeout period in seconds.</p>

</dd>
<dt id="T-login_timeout">-T login_timeout</dt>
<dd>

<p>Specifies a maximum wait time for session setup.</p>

</dd>
<dt id="V-bcdimoqru2">-V [bcdimoqru]</dt>
<dd>

<p>Security services used for Kerberos support and other security mechanisms.</p>

</dd>
<dt id="X1">-X</dt>
<dd>

<p>Initiates the login connection to the server with client-side password encryption (if supported). If either SQL Server does not recognize this option, or if the version of CT-Lib used to compile <i>sqsh</i> does not support this option, then it will be ignored. This option may also be set using the <b>$encryption</b> environment variable.</p>

</dd>
<dt id="z-language1">-z language</dt>
<dd>

<p>Specifies an alternate language to display sqsh prompts and messages. Without the -z flag, the server&#39;s default language will be used. This may also be set using the $language variable.</p>

</dd>
<dt id="Z-secmech-default-none2">-Z [secmech|default|none]</dt>
<dd>

<p>Specifies the security mechanism to use for user authentication. For example csfkrb5 for Kerberos support.</p>

</dd>
</dl>

</dd>
<dt id="reconnect--A-packet-size--c--D-db--G-tds-version--S-srv--U-user--P-pass--I-ifile--J-charset--K-keytab--R-server_principal--n--N-appname--Q-query_timeout--T-login_timeout--V-bcdimoqru--X--z-language--Z-secmech-default-none">\reconnect [-A packet size] [-c] [-D db] [-G tds version} [-S srv] [-U user] [-P pass] [-I ifile] [-J charset] [-K keytab] [-R server_principal] [-n] [-N appname] [-Q query_timeout] [-T login_timeout] [-V [bcdimoqru]] [-X] [-z language] [-Z [secmech|default|none]]</dt>
<dd>

<p>The <b>\reconnect</b> command may be used to force a reconnection to the database using a new username, server name, or password (if desired). If this command fails, the current connection remains (if there is any), however if it succeeds then the current connection is closed and the new connection becomes the only active one.</p>

<p>All arguments that are accepted by <b>\connect</b> are also accepted by <b>\reconnect</b> (in fact <b>\reconnect</b> uses <b>\connect</b> to establish the new connection).</p>

</dd>
<dt id="run">\run</dt>
<dd>

<p>This command will execute a script file like <b>\loop</b> but the <b>\run</b> command will allow optional script parameters. Furthermore the command accepts the following parameters.</p>

<dl>

<dt id="e1">-e</dt>
<dd>

<p>Run the script file with echo on.</p>

</dd>
<dt id="f">-f</dt>
<dd>

<p>Suppress footers.</p>

</dd>
<dt id="h1">-h</dt>
<dd>

<p>Suppress headers.</p>

</dd>
<dt id="l">-l</dt>
<dd>

<p>Suppres separator lines with pretty output style.</p>

</dd>
<dt id="n4">-n</dt>
<dd>

<p>Disable SQL buffer variable expansion.</p>

</dd>
<dt id="p1">-p</dt>
<dd>

<p>Report runtime statistics.</p>

</dd>
<dt id="m-style1">-m style</dt>
<dd>

<p>Specify output style {bcp|csv|horiz|html|meta|none|pretty|vert}.</p>

</dd>
<dt id="i-filename1">-i filename</dt>
<dd>

<p>Required parameter to specify a filename to be run by <i>sqsh</i>.</p>

</dd>
</dl>

<p>For example: <b>\run -p -i ~/tmp/runtst.sqsh 10 -m pretty</b></p>

</dd>
<dt id="lcd-dirname">\lcd dirname</dt>
<dd>

<p>Local Change Directory. This command takes a directory name as argument and changes the local SQSH context to this directory. You can use <b>\lcd -</b> to return back to the previous directory. If you exit <i>sqsh</i> then the shell is still in the same directory from where sqsh was started.</p>

</dd>
<dt id="pwd">\pwd</dt>
<dd>

<p>Print Working Directory. Show the name of the current local working directory.</p>

</dd>
<dt id="ls">\ls</dt>
<dd>

<p>List files in the current directory. Does not take any arguments and is basically a shortcut for <b>\shell ls</b>.</p>

</dd>
<dt id="snace">\snace</dt>
<dd>

<p>Will show the session expiration interval for a network authenticated session, like in a Kerberos enabled session, for example.</p>

</dd>
<dt id="go-options-xacts">\go [options] [xacts]</dt>
<dd>

<p>Sends the contents of the <b>Work Buffer</b> to the database, establishing a new connection to the database if one does not already exist (by calling the <b>\connect</b> above). It them displays the results of the query back to stdout and returns, causing the <b>Work Buffer</b> to be cleared and moved to the end of the <b>History Buffer</b>.</p>

<p>If the <b>Work Buffer</b> is empty and the <b>$repeat_batch</b> variable is set to &quot;On&quot;, <b>\go</b> will attempt to re-run the last command executed (this will only work in interactive mode if history support is enabled).</p>

<p><b>\go</b> accepts the following arguments:</p>

<dl>

<dt id="d-display">-d display</dt>
<dd>

<p>If X11 support is compiled into sqsh, and X display mode is being used (see <b>-x</b>, below), then <i>display</i> will be used as the X display area for the result set. By default the environment variable <b>$DISPLAY</b> is assumed.</p>

</dd>
<dt id="e2">-e</dt>
<dd>

<p>Echo the expanded SQL buffer before sending it to the server.</p>

</dd>
<dt id="f1">-f</dt>
<dd>

<p>Turns off the display of the footer message &quot;(%d rows affected)&quot;. Footer messages may also be turned off via the <b>$footers</b> variable.</p>

</dd>
<dt id="h2">-h</dt>
<dd>

<p>Turns off all column headers. These may also be turned off via the <b>$headers</b> variable.</p>

</dd>
<dt id="m-style2">-m style</dt>
<dd>

<p>Temporarily changes the display style to <i>style</i> for the duration of the command. Currently supported styles are <b>horiz</b> (or <b>hor</b> or <b>horizontal</b>), <b>vert</b> (or <b>vertical</b>), <b>bcp</b>, <b>csv</b>, <b>html</b>, <b>meta</b>, <b>pretty</b> and <b>none</b>. The display style may be permanently set via the <b>$style</b> variable or the <b>-m</b> command line flag.</p>

</dd>
<dt id="l1">-l</dt>
<dd>

<p>Suppress separator lines when using the <b>-m pretty</b> output style. May also be turned off via the <b>$nosepline</b> variable.</p>

</dd>
<dt id="n5">-n</dt>
<dd>

<p>Turns off variable expansion in the <b>Work Buffer</b> prior to sending it to the server, this may also be turned off via the <b>$expand</b> variable.</p>

</dd>
<dt id="p-out-err-none">-p out|err|none</dt>
<dd>

<p>Output performance statistics to the given stream (stdout or stderr) when the result set has been successfully returned from the server. This may also be turned on via the <b>-p</b> command line argument to sqsh, or the <b>$statistics</b> variable, in which case the statistics will be written to stdout. If the argument is &quot;none&quot; then no statistics will be written.</p>

</dd>
<dt id="s-sec">-s sec</dt>
<dd>

<p>If the value of <i>xacts</i> is greater than 1, this causes sqsh to sleep for <i>sec</i> seconds before executing the next transaction. Note that the time spent sleeping is excluded from the statistical information displayed with the <b>-p</b> flag.</p>

</dd>
<dt id="t-filter1">-t [filter]</dt>
<dd>

<p>Filters the command batch through an external program, <i>filter</i>, and prior to being sent to the SQL Server. If <i>filter</i> is not supplied, then <b>$filter_prog</b> is used (default is &#39;m4 -&#39;). This value may also be set via the <b>$filter</b> and <b>$filter_prog</b> variables.</p>

</dd>
<dt id="w-width1">-w width</dt>
<dd>

<p>Overrides the value of <b>$width</b> for the life of the query (see <b>$width</b> below).</p>

</dd>
<dt id="x-xgeom">-x [xgeom]</dt>
<dd>

<p>Turns on the X11 display filter (only if X11 support is compiled into sqsh), which causes the result set to be sent to a separate window. If <i>xgeom</i> is supplied, then this value will be used as <b>$xgeom</b> for the life of the query (see <b>$xgeom</b> below).</p>

</dd>
<dt id="T-xwin_title">-T xwin_title</dt>
<dd>

<p>Specify the title name of the X result window to create. This will temporarily override the value of <b>$xwin_title</b>. Only useful to specify -T in conjunction with <b>-x</b>.</p>

</dd>
<dt id="xacts">xacts</dt>
<dd>

<p>Specifies number of times the contents of the <b>Work Buffer</b> should be executed. Note that, similar to isql, a result set will only be displayed during the final execution of the batch. Also, the contents of the <b>Work Buffer</b> are only expanded once, prior to the first execution, so the contents of the buffer will not change between subsequent executions.</p>

</dd>
</dl>

</dd>
<dt id="bcp-bcp_options-table-:slicenumber-:partition-name">\bcp [bcp_options] table[:slicenumber|:partition name]</dt>
<dd>

<p>The <b>\bcp</b> commands acts as a sort of enhanced <b>\go</b> command that redirects the result set(s) of the batch to another server via the bcp protocol. While it is possible to <b>\bcp</b> the result set back to the current server (the <b>$DSQUERY</b> variable), this is achieved more easily via a SELECT INTO.</p>

<p>The nitty-gritty details of <b>\bcp</b> go like this: First the current SQL batch is expanded (unless the <b>$expand</b> variable is set to 0) and shipped off to the database for processing. If all goes well, a new connection is established to the destination database (as specified via <b>$DSQUERY</b> or the <b>-S</b> flag) to transfer the result set using bcp. Then, the output of the source database connection is bound to the new bcp connection and data transfer is performed. <b>\bcp</b> can handle multiple result sets without any problem (including result sets returned from stored procedures, etc.) provided that all of the result sets are valid for the destination table.</p>

<p>The equivalent of a &quot;bcp out&quot; may be performed using the <b>bcp</b> display style setting and file redirection (see the <b>$style</b> variable).</p>

<dl>

<dt id="A-packet">-A packet</dt>
<dd>

<p>Specifies the TDS packet size used to communicate with the destination server. If not supplied this defaults to the value the <b>$packet_size</b> variable, or (if that is not set), the default server packet size (usually 512 bytes).</p>

</dd>
<dt id="b-batch_size">-b batch_size</dt>
<dd>

<p>The number of records transferred in a single transaction between servers. Note that reaching the end of a result causes the batch to be transferred, regardless of the value of <i>batch_size</i>. The default is the entire result set.</p>

</dd>
<dt id="i-initialization-command">-i &quot;&lt;initialization command&gt;&quot;</dt>
<dd>

<p>Using the <i>-i</i> parameter you can send a SQL command to the target server that will be executed just before the bulk copy operation is started. This is useful if you need to truncate the target table first. For example:</p>

<pre><code>    1&gt; select * from proddb..materials
    2&gt; \bcp -SDTA -i &quot;truncate table testdb..materials&quot; -N -X testdb..materials</code></pre>

</dd>
<dt id="I-ifile1">-I ifile</dt>
<dd>

<p>The full path of an alternate Sybase <i>interfaces</i> file to use.</p>

</dd>
<dt id="J-charset2">-J charset</dt>
<dd>

<p>Specifies the default <i>charset</i> used to communicate with the SQL Server. This defaults to the current character set (the value of the <b>$charset</b> variable).</p>

</dd>
<dt id="m-maxerr">-m maxerr</dt>
<dd>

<p>The maximum number of batches that may fail before <b>\bcp</b> gives up the ghost (default is 10). Note that this only refers to failures within a given batch. When performing a bcp of multiple result sets to a server, if a given result set has, say, too many columns or bad data types, then the entire bcp process is aborted regardless of the value of <i>maxerr</i>.</p>

</dd>
<dt id="N1">-N</dt>
<dd>

<p>Indicates that the value for an identity column in the destination table is being supplied within the result set.</p>

</dd>
<dt id="P-password2">-P password</dt>
<dd>

<p>The <i>password</i> for <i>user</i> required to connect to <i>server</i>. This defaults to <b>$password</b> if not supplied.</p>

</dd>
<dt id="S-server-host:port-:filter2">-S server | host:port[:filter]</dt>
<dd>

<p>The name or address of the Sybase <i>server</i> to connect, this defaults to <b>$DSQUERY</b> if not supplied.</p>

</dd>
<dt id="T">-T</dt>
<dd>

<p>Transfer the data in transit without performing character set conversion at the client side.</p>

</dd>
<dt id="U-user1">-U user</dt>
<dd>

<p>The Sybase <i>user</i> to connect to the database as, this defaults to <b>$username</b> variable if not supplied.</p>

</dd>
<dt id="X2">-X</dt>
<dd>

<p>Causes password negotiation with the destination server to be performed using client-side encryption.</p>

</dd>
<dt id="z-language2">-z language</dt>
<dd>

<p>Specifies the language setting to use.</p>

</dd>
<dt id="table-:slicenumber-:partition-name">table[:slicenumber|:partition name]</dt>
<dd>

<p>As with regular <b>bcp</b>, <i>table</i> may be either a fully or partially specified table name in the destination server. Note that since a new database connection is established during the bcp processes that the database context of the connection may not be the same as the current context, so it is usually safest to fully specify the table name in the form database.owner.table. For partitioned tables you may supply a slicenumber or a partition name (separate table name and partition with a colon (:)) to bcp the data into the specified partition.</p>

</dd>
</dl>

</dd>
<dt id="rpc-rpc_opt-rpc_name-parm_opt-var-value">\rpc [rpc_opt] rpc_name [[parm_opt] [@var=]value ...]</dt>
<dd>

<p>The <b>\rpc</b> command is used to directly invoke a stored procedure call in the connected server. This command is particularly useful for communicating with an Open Server that does not directly support language calls.</p>

<p><b>\rpc</b> invokes the remote procedure <i>rpc_name</i> with one or more parameters that may be named (using <i>@var</i>) or anonymous (by not supplying a name). Unfortunately, due to the fact that Sybase&#39;s implementation of RPC&#39;s, does not directly support most implicit data type conversions (mainly between VARCHAR (the string you supply on the command line) and the most other data types (that the remote procedure is expecting), the syntax for the <b>\rpc</b> command is somewhat complex. However, in short here is how things work:</p>

<p>As the <b>\rpc</b> command line is being parsed, <i>sqsh</i> attempts to guess the data type of the parameter <i>value</i> based on the format (for example if it contains only digits, it is assumed to be an integer), <i>sqsh</i> then performs an explicit data type conversion prior to calling the remote procedure call. If <i>sqsh</i> guesses wrong, several flags are supplied to force it to perform the correct data type conversion (see <b>parm_opt</b>).</p>

</dd>
</dl>

<h3 id="Display-Options">Display Options</h3>

<p>The following options may be supplied anywhere on the command line and are used to affect the manner in which the result set(s) returning from the remote procedure call are displayed:</p>

<dl>

<dt id="d-display1">-d display</dt>
<dd>

<p>If X support is compiled into sqsh, the value of <i>display</i> is used as the X windows DISPLAY variable. Note, this is usually supplied with the <b>-x</b> flag, below.</p>

</dd>
<dt id="f2">-f</dt>
<dd>

<p>Turns off the display of the footer message &quot;(%d rows affected)&quot;. Footer messages may also be turned off via the <b>$footers</b> variable.</p>

</dd>
<dt id="h3">-h</dt>
<dd>

<p>Turns off all column headers. These may also be turned off via the <b>$headers</b> variable.</p>

</dd>
<dt id="m-style3">-m style</dt>
<dd>

<p>Temporarily changes the display style to <i>style</i> for the duration of the command. Currently supported styles are <b>horiz</b> (or <b>hor</b> or <b>horizontal</b>), <b>vert</b> (or <b>vertical</b>), <b>bcp</b>, <b>csv</b>, <b>html</b>, <b>meta</b>, <b>pretty</b> and <b>none</b>. The display style may be permanently set via the <b>$style</b> variable or the <b>-m</b> command line flag.</p>

</dd>
<dt id="r">-r</dt>
<dd>

<p>Request to recompile the procedure prior to execution.</p>

</dd>
<dt id="w-width2">-w width</dt>
<dd>

<p>Temporarily sets the output width to <i>width</i>. The output width may be permanently set via the <i>$width</i> variable.</p>

</dd>
<dt id="x-xgeom1">-x [xgeom]</dt>
<dd>

<p>Sends output to a separate X window. If <i>xgeom</i> is supplied, then the X window uses this geometry (see <b>$xgeom</b> for details).</p>

</dd>
<dt id="T-xwin_title1">-T xwin_title</dt>
<dd>

<p>Specify the title name of the X result window to create. This will temporarily override the value of <b>$xwin_title</b>. Only useful to specify -T in conjunction with <b>-x</b>.</p>

</dd>
</dl>

<h3 id="Parameter-Options">Parameter Options</h3>

<p>The following options may be supplied immediately prior to specifying a parameter <i>value</i> and are used to affect the way in which <i>sqsh</i> interprets the contents of the <i>value</i> prior to calling the remote procedure. Although <i>sqsh</i> will allow any combination of these parameters to be combined, it only really makes sense to combine the <b>-x</b> flag with any other flag.</p>

<dl>

<dt id="b1">-b</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to VARBINARY before calling <i>rpc_name</i>. This flag is implicit (i.e. you need not supply it) if <i>value</i> starts with &quot;0x&quot; and contains only digits.</p>

</dd>
<dt id="c1">-c</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to VARCHAR prior to calling <i>rpc_name</i>. This flag is implicit if <i>value</i> does not match any of the implicit conversions for the other data types.</p>

</dd>
<dt id="d">-d</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to double (float) before calling <i>rpc_name</i>. This flag is implicit if <i>value</i> is in valid floating point notation (e.g. 0.1, .1, 1.4e10, or 4e10).</p>

</dd>
<dt id="i1">-i</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to integer (int) before calling <i>rpc_name</i>. This flag is implicit if <i>value</i> contains only digits (and, optionally, a leading sign).</p>

</dd>
<dt id="y">-y</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to money before calling <i>rpc_name</i>. This flag is implicit if <i>value</i> begins with a &quot;$&quot;, and contains only digits and, optionally, a decimal.</p>

</dd>
<dt id="n6">-n</dt>
<dd>

<p>Indicates that the <i>value</i> that is specified should be converted to numeric before calling <i>rpc_name</i>. This flag is never implicit, as <i>value</i> would always match either int (<b>-i</b>) or float (<b>-d</b>); however, both of these types will implicitly be converted to a numeric as necessary by the procedure call.</p>

</dd>
<dt id="u">-u</dt>
<dd>

<p>Indicates that <i>value</i> should be ignored and treated as a NULL value, This flag is implicit if <i>value</i> is &quot;&quot;.</p>

</dd>
</dl>

<h2 id="Buffers1">Buffers</h2>

<p>The following commands may be used to create, destroy, or manipulate the various buffers described in the <b>BUFFERS</b> section, above.</p>

<dl>

<dt id="clear">\clear</dt>
<dd>

<p>The <b>\clear</b> command will discard the current buffer and in contradiction with the <b>\reset</b> command, will not save the current buffer to the history. When sqsh is compiled with readline support, this command will also clear the screen. (as ^l does.) The alias <b>clear</b> is automatically established upon startup.</p>

</dd>
<dt id="history--i--x-count">\history [-i] [-x count]</dt>
<dd>

<p>Displays the last <b>$histsize</b> batches that have either been sent to the database via the <b>\go</b> command or cleared from the <b>Work Buffer</b> via the <b>\reset</b> command. With option <b>-i</b> also display the number of times the buffer is used and the last time the buffer was used. This information may be of special interest when using the <b>$histunique</b> feature. The <b>-x</b> option may specify the number of most recent history entries to display instead of the total list of history entries.</p>

</dd>
<dt id="hist-load-filename">\hist-load [filename]</dt>
<dd>

<p>Load a history file and append items to the current history list. Use <b>$history</b> if no filename is specified as a parameter.</p>

</dd>
<dt id="hist-save-filename">\hist-save [filename]</dt>
<dd>

<p>Will save the current history buffers to the <b>$history</b> file or to the filename specified as a parameter.</p>

</dd>
<dt id="redraw">\redraw</dt>
<dd>

<p>Returns a request back to the current read-eval-print loop for it to redisplay the current <b>Work Buffer</b>. If run from non-interactive mode, this command has no effect.</p>

</dd>
<dt id="reset">\reset</dt>
<dd>

<p>The <b>\reset</b> command corresponds directly to the <i>isql</i> &#39;reset&#39; command, returning a request to the read-eval-print loop to clear the contents of the current <b>Work Buffer</b> and, if you are running in interactive mode, place a copy of the buffer into the <b>History Buffer</b>. The alias <b>reset</b> is automatically established upon startup of <i>sqsh</i> for backward compatibility with <i>isql</i>.</p>

</dd>
<dt id="buf-append-dst-buffer-src-buffer">\buf-append dst-buffer [src-buffer]</dt>
<dd>

<p>Appends the contents of <i>src-buffer</i> (defaults to !.) to the contents of <i>dst-buffer</i>, if it exists. If <i>dst-buffer</i> doesn&#39;t exist it is created.</p>

</dd>
<dt id="buf-copy-dst-buffer-src-buffer">\buf-copy dst-buffer [src-buffer]</dt>
<dd>

<p>Copies the contents of <i>src-buffer</i> (defaults to <b>!.</b>, the <b>Work Buffer</b>, if not supplied), to <i>dst-buffer</i>. Refer to <b>BUFFERS</b> for information on buffer naming conventions.</p>

</dd>
<dt id="buf-del-buffer-range">\buf-del [buffer|range]</dt>
<dd>

<p>Remove a history buffer from the history list. You can also specify a range list consisting of the first and last buffer numbers separated by a &#39;-&#39;. For example: &quot;\buf-del 1-10&quot; will delete the first 10 history entries. Another example, &quot;\buf-del 21&quot; will only delete buffer number 21. Note that the history buffers will be renumbered consecutively.</p>

</dd>
<dt id="buf-edit--r-read-buf--w-write-buf">\buf-edit [-r read-buf] [-w write-buf]</dt>
<dd>

<p>The <b>\buf-edit</b> command is used to edit the contents of a buffer and place the changes into another buffer. This command may only be run while in interactive mode. If <i>read-buf</i> is not supplied then the buffer to be edited defaults to !., if it is not empty, otherwise it defaults to !!. If <i>write-buf</i> is not supplied then the edited buffer is written back to !..</p>

<p>By default, <b>\buf-edit</b> uses the environment variable <b>$EDITOR</b> first, followed by <b>$VISUAL</b> to determine which editor to use, defaulting to &#39;vi&#39; if the variable is not set.</p>

<p>It is important to note that as of release 1.2, <b>\buf-edit</b> is no longer able to use the name of an alias to it as the name of the editor to launch. This is primarily due to the change in the behavior of alias (see section <b>Aliasing</b>, below, for details).</p>

<p>The commands <b>edit vi</b> and <b>emacs</b> are automatically established upon startup of <i>sqsh</i> for backward compatibility with <i>isql</i>.</p>

</dd>
<dt id="buf-get-buffer">\buf-get buffer</dt>
<dd>

<p>The <b>\buf-get</b> command is supplied as a shorthand method of running <b>\buf-copy</b> It is the equivalent of running:</p>

<pre><code>    \buf_append !. buffer</code></pre>

</dd>
<dt id="buf-load--a-filename-dst-buffer">\buf-load [-a] filename [dst-buffer]</dt>
<dd>

<p>Copies the contents of <i>filename</i> in <i>dst-buffer</i> (defaults to !.). If the <b>-a</b> flag is supplied, the contents of <i>filename</i> are appended to <i>dst-buffer</i>. Note that it is illegal to attempt to write to the contents of the history buffer.</p>

</dd>
<dt id="buf-save--a-filename-src-buffer">\buf-save [-a] filename [src-buffer]</dt>
<dd>

<p>Saves the contents of <i>src-buffer</i> (defaults to !.) to <i>filename</i>. If the <b>-a</b> flag is supplied the contents are appended to <i>filename</i> rather than overwriting the current contents.</p>

</dd>
<dt id="buf-show-buffer">\buf-show [buffer]</dt>
<dd>

<p>Displays the contents of the named <i>buffer</i>. If <i>buffer</i> is not supplied, then the contents of all named buffers are displayed. This command is slightly different from the commands above in that it is only legal to supply a <b>Named Buffer</b> <i>buffer</i>, <b>History Buffers</b>, and the <b>Work Buffer</b> will have no results.</p>

</dd>
</dl>

<h2 id="Variables1">Variables</h2>

<p>The following command(s) are used to manipulate the contents of internal variables and environment variables.</p>

<dl>

<dt id="set--x-name-value">\set [-x] [name=<i>value</i> ...]</dt>
<dd>

<p>If no arguments are supplied to <b>\set</b> then the current values of all variables are displayed. Otherwise the variable <i>name</i> is set to <i>value</i>. Note that some internal variables (see <b>SPECIAL VARIABLES</b>) may only be set with certain <i>value</i>s, so this action may fail, leaving the previous contents on <i>name</i> intact. The <b>-x</b> flag causes the variable to be exported to the environment of any programs launched from <i>sqsh</i>.</p>

</dd>
</dl>

<h2 id="Job-Control">Job Control</h2>

<p>The following commands are used to view the status of, or manipulate background jobs that are currently running, these correspond roughly to the commands supplied by such shells as <b>csh(1)</b>.</p>

<dl>

<dt id="jobs--i">\jobs [-i]</dt>
<dd>

<p>Displays the status of any currently running jobs, including whether or not these jobs have pending output, how long they have been running, and when they were started. The <b>-i</b> option will show some additional job information. Note that the total run time of the job is determined from the moment the job is marked complete by the read-eval-print loop when polled, not when it actually ended and is flagged as terminated by the signal handler.</p>

</dd>
<dt id="wait-job_id">\wait [job_id]</dt>
<dd>

<p>Will pause until job designated by <i>job_id</i> completes. If <i>job_id</i> is a negative number then <b>\wait</b> will pause until <i>any</i> pending jobs completes. If there are no jobs pending, or <i>job_id</i> does not belong to a running job, then an error message is displayed. Note that if multiple jobs are running, and a <b>\wait</b> is issued for one of them, the other jobs may not automatically get signaled when completed within the wait period of the specific job. The other jobs may need to get signaled with a <b>\wait -1</b> as well to be noticed complete by <i>sqsh</i>.</p>

</dd>
<dt id="kill-job_id">\kill job_id</dt>
<dd>

<p>Terminates the job specified by <i>job_id</i>, throwing away any output that may be deferred for the job. If <i>job_id</i> is not a running job then an error message is displayed.</p>

</dd>
<dt id="show-job_id">\show job_id</dt>
<dd>

<p>Displays the deferred output of completed background job <i>job_id</i> and removes the job from the list of pending jobs (removing the defer file in the process). If <i>job_id</i> is still running, or is not a valid complete job, then an error message is displayed. You may need to issue a <b>\wait job_id</b> first, to get notified of actual job completion.</p>

</dd>
</dl>

<h2 id="Aliasing">Aliasing</h2>

<p>As of release 1.2, <i>sqsh</i> supports full <i>csh</i>-style command aliasing. With this feature, <i>sqsh</i> checks the first word of each line, <i>prior to any form of expansion</i>, to see if it matches the name of an existing alias. If it does, the command is reprocessed with the alias definition replacing its name. Unlike <i>csh</i>, however, only one form of history substitution is available within an alias: the &#39;<b>!*</b>&#39; entry, indicating the current line being expanded. If no history expansion is called for, the arguments on the command line remain unchanged.</p>

<p>Like <i>csh</i>, aliases are not recursively expanded, so it is perfectly legal to create an alias that expands to a command by the same name.</p>

<p>The following command is used to create an alias:</p>

<dl>

<dt id="alias-alias_name-alias_body">\alias [alias_name=alias_body]</dt>
<dd>

<p>If no arguments are supplied to the <b>\alias</b> command, then the list of aliases currently in effect is displayed. Otherwise, it creates a new alias with a name of <i>alias_name</i> and a body of <i>alias_body</i>; if <i>alias_name</i> already exists, the body of the existing <i>alias_name</i> is replaced with the new definition.</p>

<p>After defining the new alias, whenever <i>sqsh</i> encounters a line beginning with <i>alias_name</i>, the remainder of the line is replaced with <i>alias_body</i> before any further processing is performed.</p>

<p>If the string &#39;<b>!*</b>&#39; exists anywhere within <i>alias_body</i>, the arguments supplied to the alias are inserted at that point, otherwise the argument are appended to the end of the alias definition. For example:</p>

<pre><code>    1&gt; \alias hi=&#39;\echo !* said hello&#39;
    1&gt; hi Scott
    Scott said hello</code></pre>

<p>where as if the alias does not include the <b>!*</b> keyword, then it behaves like so:</p>

<pre><code>    1&gt; \alias hi=&#39;\echo said hello&#39;
    1&gt; hi Scott
    said hello Scott</code></pre>

<p>It is perfectly legal to include a <b>!*</b> more than once within a given <i>alias_body</i>. Currently there is no way to escape the string <b>!*</b>, if you really need this feature send me mail.</p>

</dd>
<dt id="unalias-alias_name">\unalias alias_name</dt>
<dd>

<p>Removes <i>alias_name</i>.</p>

</dd>
</dl>

<h2 id="Miscellaneous">Miscellaneous</h2>

<p>The left over commands.</p>

<dl>

<dt id="exit-x">\exit [x]</dt>
<dd>

<p>The <b>\exit</b> command requests that current read-eval-print loop cease processing. When the last loop returns, <i>sqsh</i> <b>exit(1)</b>s. You may specify a exit code as parameter which will be stored in <b>$exit_value</b> and will be used as return value to the shell upon exit of <i>sqsh</i>. (0 &lt;= x &lt;= 255).</p>

</dd>
<dt id="abort">\abort</dt>
<dd>

<p>Causes all nested read-eval-print loops to abort processing, causing <i>sqsh</i> to exit with an exit value of 254 (see section <b>EXIT STATUS</b>).</p>

</dd>
<dt id="read--a--n--h-var_name-filename">\read [-a] [-n] [-h] var_name [&lt; filename]</dt>
<dd>

<p>Reads a line of input from the user, placing the text of the line in the variable <i>var_name</i>. If the <b>-n</b> is used, then the trailing new-line is left on the line of text, and if <b>-a</b> is supplied, then the text of the line is appended to the existing value of <i>var_name</i>. The <b>-h</b> flag turns off echoing of typed characters back to the user. It is also possible to read the contents of a file using the <i>\&lt;</i> file redirection notation.</p>

</dd>
<dt id="sleep-seconds">\sleep seconds</dt>
<dd>

<p>Causes <i>sqsh</i> too pause for <i>seconds</i>. This is useful within scripts of batches which need to pause briefly between batches (it was primarily useful to me for testing background jobs).</p>

</dd>
<dt id="echo--n-args">\echo [-n] [args ...]</dt>
<dd>

<p>Just like the UNIX <b>echo(1)</b>, this prints its arguments to stdout, followed by a new-line. If the <b>-n</b> flag is supplied, the newline is omitted.</p>

</dd>
<dt id="warranty">\warranty</dt>
<dd>

<p>Displays the standard GNU warranty.</p>

</dd>
<dt id="help-command">\help [command]</dt>
<dd>

<p>Without any arguments <b>\help</b> displays a brief list of all available commands, otherwise, it provides specific help for <i>command</i>, if available. When help is requested on a specific <i>command</i>, <b>\help</b> looks for the file <i>$help_dir/command.hlp</i> and displays it to stdout.</p>

</dd>
<dt id="shell-shell-command">\shell [shell command]</dt>
<dd>

<p>If <i>shell command</i> is not supplied then <i>sqsh</i> executes <b>$SHELL</b>. If the <b>$SHELL</b> variable has not been set, then, by default, /bin/sh is executed. Otherwise, if <i>shell command</i> is supplied then it is executed. The exit status of the command executed is stored in the special <b>$?</b> read-only environment variable.</p>

</dd>
<dt id="lock">\lock</dt>
<dd>

<p>Locks the current session until the correct password is typed. By default <b>\lock</b> attempts to use the UNIX password (from /etc/passwd or /etc/shadow) associated with the user running <i>sqsh</i> (if sqsh is linked with the crypt library), however if the <b>$lock</b> variable is set then the contents of that is used for validation instead.</p>

</dd>
</dl>

<h2 id="Aliases">Aliases</h2>

<p>The following aliases are established upon startup of <i>sqsh</i>, and are provided primarily for backward compatibility with <i>isql</i>. These may be removed at any time using the <b>\unalias</b> command (either at the prompt, or within your .sqshrc file).</p>

<dl>

<dt id="pod6">!</dt>
<dd>

<p>The <b>!</b> alias is provided as a <b>csh(1)</b>-like history mechanism, and is an alias of <b>\buf-append</b>. With release 0.7, this alias is provided only for backwards compatibility with previous releases of <i>sqsh</i>. See <b>SPECIAL VARIABLES</b>, <b>$history_shorthand</b> for details on the new shorthand mechanism (the new shorthand more closely resembles that of <b>csh</b>).</p>

</dd>
<dt id="clear1">clear</dt>
<dd>

<p>An alias for the <b>\clear</b> command, which causes the contents of the current work buffer to be cleared and discarded. Also the screen will be cleared if readline is compiled into <i>sqsh</i>.</p>

</dd>
<dt id="reset1">reset</dt>
<dd>

<p>An alias for the <b>\reset</b> command, which causes the contents of the current work buffer to be cleared and copied to history (if in interactive mode).</p>

</dd>
<dt id="exit-x1">exit [x]</dt>
<dd>

</dd>
<dt id="quit-x">quit [x]</dt>
<dd>

<p>An alias for the <b>\exit [x]</b> command, causes the current read-eval-print loop to complete.</p>

</dd>
<dt id="edit">edit</dt>
<dd>

</dd>
<dt id="vi">vi</dt>
<dd>

</dd>
<dt id="emacs">emacs</dt>
<dd>

<p>These are provided as aliases for the <b>\buf-edit</b> command. See <b>COMMANDS-Buffers</b> for information on the interactions between <b>\buf-edit</b> and aliases.</p>

</dd>
<dt id="go">go</dt>
<dd>

<p>Provided as an alias for the <b>\go</b> command (for obvious reasons).</p>

</dd>
<dt id="help">help</dt>
<dd>

<p>An alias for the <b>\help</b> command.</p>

</dd>
</dl>

<h3 id="In-Line-go">In-Line \go</h3>

<p>If the variable <b>$semicolon_hack</b> is set to 1 (on), then sqsh supports what is called an in-line <b>\go</b> feature. This allows the current command batch to be terminated and sent to the database in a single step by appending a &#39;;&#39; onto the end of the current work buffer. This allows</p>

<pre><code>    1&gt; sp_who;</code></pre>

<p>To behave in the same manner as if you had typed:</p>

<pre><code>    1&gt; sp_who
    2&gt; \go</code></pre>

<p>Likewise, anything following the semicolon is passed to the <b>\go</b> command just as if it was run as a normal command:</p>

<pre><code>    1&gt; sp_who ; 2&gt;/dev/null | more</code></pre>

<p>Unlike most other <i>isql</i> replacements, <i>sqsh</i> attempts to be smart about the semicolons. If a semicolon is contained within a set of single or double quotes it will not be interpreted. This includes multiple quotes. For example:</p>

<pre><code>    1&gt; select &quot;This is a multiple line
    2&gt; quote; it is smart!&quot; ;</code></pre>

<p>In the above example, only the second semicolon (the one at the end of the line) will be interpreted. The variable <b>$semicolon_cmd</b> is a string that contains the command that will be substituted by the semicolon which is <b>\go</b> by default. But you can change that to <b>\bcp</b> for example and execute:</p>

<pre><code>    1&gt; select * from pubs2..titles; -S... tempdb..titles</code></pre>

<p>In sqsh-2.2.0 you can also set variable <b>$semicolon_hack2</b> to allow multiple commands on one line to be fired by a semicolon. If this option is set you cannot use the construct above to pass additional parameters to the <b>\go</b> command. But of course you can change <b>$semicolon_cmd</b> to your needs as this command will be used to execute SQL batches.</p>

<pre><code>    echo &quot;exec sp_who;exec sp_helpdb;\echo Done;&quot; | sqsh -S... -U... -P...</code></pre>

<p>In this example the semicolon acts as a <b>\go</b> command to a SQL buffer and as a command separator for sqsh commands that will be executed in sequence. Note that <b>$semicolon_hack2</b> takes precedence over <b>$semicolon_hack</b>.</p>

<h1 id="SPECIAL-VARIABLES">SPECIAL VARIABLES</h1>

<p>There are several options that are configurable via the command line options to <i>sqsh</i>, however these are by no means complete. There are many aspects of <i>sqsh</i>&#39;s behavior that may only be modified by setting special variables. (In fact, the command line options really only set these variables for you).</p>

<h2 id="Variable-Data-types">Variable Data types</h2>

<p>Next to all of the variables that follow is the type of data with which they may be set. Any attempts to set the variable with a type of data that it does not accept will fail.</p>

<dl>

<dt id="string">string</dt>
<dd>

<p>Any sequence characters.</p>

</dd>
<dt id="boolean">boolean</dt>
<dd>

<p>A positive <i>boolean</i> value may be represented as either &quot;True&quot;, &quot;Yes&quot;, &quot;1&quot;, or &quot;On&quot; (case insensitive) and a negative boolean value may be represented as &quot;False&quot;, &quot;No&quot;, &quot;0&quot;, or &quot;Off&quot; (case insensitive). However, internally the value of the variable will always be represented as either a &quot;1&quot; or &quot;0&quot;.</p>

</dd>
<dt id="path">path</dt>
<dd>

<p>Must be the <i>path</i> name that is readable by the <i>sqsh</i> program.</p>

</dd>
<dt id="int">int</dt>
<dd>

<p>Must be one or more digits. Note that some variables also restrict the range of the integer.</p>

</dd>
<dt id="date-spec">date-spec</dt>
<dd>

<p>This is a string of the format used to specify dates and times for the <b>date(1)</b> command, or the <b>strftime(3C)</b> and <b>cftime(3C)</b> standard C library functions. For example &#39;%H:%M:%S&#39; specifies a time of hours in 24 hour format, followed by a colon, followed by minutes, followed by a colon, followed by seconds.</p>

</dd>
<dt id="float-format">float-format</dt>
<dd>

<p>A string of the format <b>p.s</b>, where <b>p</b> is the total precision of a floating point value (the total number of digits to be displayed, including those following the decimal) and <b>s</b> is the scale of the value (the total number of digits following the decimal to be displayed).</p>

</dd>
</dl>

<h3 id="Variables2">Variables</h3>

<p>The following variables have special meanings within <i>sqsh</i> and the setting of these variables alter the behavior of the shell.</p>

<dl>

<dt id="int1">$? (int)</dt>
<dd>

<p>This read-only variable may contain the following return value:</p>

<ul>

<li><p>The most recent error number returned from the SQL Server (@@errno) of severity &gt; 10 (above informational messages).</p>

</li>
<li><p>The exit value of a previously executed pipe command.</p>

</li>
<li><p>The return value of the most recently executed sqsh function.</p>

</li>
<li><p>The result of the last executed \if statement:</p>

<dl>

<dt id="The-test-evaluated-to-True">0 - The test evaluated to True.</dt>
<dd>

</dd>
<dt id="The-test-evaluated-to-False">1 - The test evaluated to False.</dt>
<dd>

</dd>
<dt id="There-was-an-error-in-the-test-specification">2 - There was an error in the test specification.</dt>
<dd>

</dd>
</dl>

</li>
</ul>

</dd>
<dt id="int2">$# (int)</dt>
<dd>

<p>Contains the number of arguments passed into the sqsh function or script.</p>

</dd>
<dt id="string-list">$* (string list)</dt>
<dd>

<p>Expands to the complete list of arguments supplied to the function or script when invoked.</p>

</dd>
<dt id="N-int">${0}...${N} (int)</dt>
<dd>

<p>Used to reference positional function arguments. Argument ${0} is the name of the function being called, ${1} is the first argument, etc.</p>

</dd>
<dt id="pod7">$$</dt>
<dd>

<p>Expands to the process ID of the current running sqsh session.</p>

</dd>
<dt id="DISPLAY">DISPLAY</dt>
<dd>

<p>May contain the name of the DISPLAY the X-server uses to put the XWindows result window when using <b>\go -x</b>. Defaults to the <i>$DISPLAY</i> shell environment.</p>

</dd>
<dt id="appname">appname</dt>
<dd>

<p>Contains the name <i>sqsh</i> uses to identity itself to the server. Defaults to sqsh-2.1.7. The application name can be retrieved from the sysprocesses table like: select program_name from master.dbo.sysprocesses where spid=@@pid;</p>

</dd>
<dt id="autouse-string">autouse (string)</dt>
<dd>

<p>Note: the meaning of this variable has been deprecated.</p>

<p>If <b>$autouse</b> is set, and the <b>$database</b> variable has not been set, then this variable causes <b>\connect</b> to perform a &quot;use <b>$autouse</b>&quot; once a connection has been established.</p>

<p>This variable may also be set using the <b>-D</b> command line option.</p>

</dd>
<dt id="banner-boolean">banner (boolean)</dt>
<dd>

<p>Turns off the banner message displayed on startup, this variable defaults to 1 and may also be turned off using the <b>-b</b> command line argument.</p>

</dd>
<dt id="batch_failcount-int">batch_failcount (int)</dt>
<dd>

<p>This internal variable is used to keep track of the number of batches that have failed to execute (essentially, the number of times that the error handler was called).</p>

<p>A batch is considered failed whenever an error of severity <b>$thresh_fail</b> is encountered. When <b>$batch_failcount</b> reaches <b>$thresh_exit</b> <i>sqsh</i> exits with an exit value of the total number of batches that have failed. Setting <b>$batch_failcount</b> to the string &quot;&quot; will cause it to reset to zero, any other value may have unpredictable results.</p>

<p>See <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="batch_pause-boolean">batch_pause (boolean)</dt>
<dd>

<p>Causes a &quot;Paused. Hit enter to continue...&quot; message to be displayed after each batch is executed. This variable, in conjunction with <b>$echo</b> is good for debugging SQL scripts specified with the <b>-i</b> option.</p>

</dd>
<dt id="bcp_colsep-string">bcp_colsep (string)</dt>
<dd>

<p>Used as a separator between columns during BCP style output (see the <b>$style</b> configuration variable and the <b>-m</b> option to the <b>\go</b> command). The default setting is &quot;|&quot;.</p>

</dd>
<dt id="bcp_rowsep-string">bcp_rowsep (string)</dt>
<dd>

<p>Used as a separator between rows during BCP style output (see the <b>$style</b> configuration variable and the <b>-m</b> option to the <b>\go</b> command). Note that, a newline (&quot;\n&quot;) is automatically appended and should not be supplied. The default setting is &quot;|&quot;.</p>

</dd>
<dt id="bcp_header-boolean">bcp_header (boolean)</dt>
<dd>

<p>Controls whether or not a header is printed with BCP style output. The default is &quot;False&quot;.</p>

</dd>
<dt id="bcp_trim-boolean">bcp_trim (boolean)</dt>
<dd>

<p>Controls whether or not BCP style output trims trailing spaces from fixed length columns. The default is &quot;True&quot;.</p>

</dd>
<dt id="builddate-none">builddate (none)</dt>
<dd>

<p>Read only variable specifying the date when the <i>sqsh</i> executable was compiled.</p>

</dd>
<dt id="buildtime-none">buildtime (none)</dt>
<dd>

<p>Read only variable specifying the time when the <i>sqsh</i> executable was compiled.</p>

</dd>
<dt id="chained-boolean">chained (boolean)</dt>
<dd>

<p>If set then sqsh uses the &quot;chained&quot; transaction mode (aka &quot;AutoCommit off&quot;). Setting this has NO effect on the current connection. It can be set via the command line argument <b>-n</b>.</p>

</dd>
<dt id="charset-string">charset (string)</dt>
<dd>

<p>If this variable is set prior to establishing a connection with SQL Server, then during the connection <i>sqsh</i> will request that the server transform to and from the requested <i>charset</i>. After establishing a connection, this variable is automatically set to the current character set in use.</p>

</dd>
<dt id="clear_on_fail-boolean">clear_on_fail (boolean)</dt>
<dd>

<p>Normally, whenever the <b>\go</b> command is run, <i>sqsh</i> clears the current work buffer of its contents, moving them to history. Setting <b>$clear_on_fail</b> to 0, leaves the current work buffer intact if a failure is encountered while sending the contents to the database. The default value is 1, or on.</p>

</dd>
<dt id="colsep-string">colsep (string)</dt>
<dd>

<p>Causes the string <i>colsep</i> to be used to delimit SQL column output columns, this defaults to &quot; &quot;, it may also be set via the command line argument <b>-s</b>.</p>

</dd>
<dt id="colwidth-int">colwidth (int)</dt>
<dd>

<p>Used to control the maximum column width displayed by the <b>pretty</b> display style (see <b>$style</b> below). If a row of a column exceeds this width, it will be wrapped in a relatively visually appealing manner at <b>$colwidth</b> characters. Note, however, that if there is enough screen width to hold all columns <b>$colwidth</b> may be exceeded until the width of the screen is reached.</p>

</dd>
<dt id="database-string">database (string)</dt>
<dd>

<p>If this variable is set prior to establishing a connection to the SQL Server, the a &quot;use <b>$database</b>&quot; is performed immediately after the connection is established. Once a connection has been established this variable will automatically be set to the current database context.</p>

</dd>
<dt id="date-date-spec">date (date-spec)</dt>
<dd>

<p>This variable may be set with a date format (see the man page for <b>date(1)</b>), and the variable expands to the current date in the supplied format. The default format for this variable is %d-%b-%y (e.g. 02-Feb-1996).</p>

</dd>
<dt id="datefmt-date-spec">datefmt (date-spec)</dt>
<dd>

<p>This variable may be set with a date format similar to <b>$date</b> and is used to control the display format of all SQL Server DATE columns. (Similar to <b>$datetime</b>.) Note that only 63 bytes are available in total for the expanded string and the remainder will be truncated.</p>

</dd>
<dt id="datetime-date-spec">datetime (date-spec)</dt>
<dd>

<p>This variable may be set with a date format similar to <b>$date</b> and <b>$time</b> and is used to control the display format of all SQL Server DATETIME, BIGDATETIME and SMALLDATETIME columns. Note that only 63 bytes are available in total for the expanded string and the remainder will be truncated.</p>

<p>Note that this features relies upon the operating system specific locale information and the setting of <b>$localeconv</b> for determining such things as the name of the month and day, rather than going through the CT-Lib locale information. This means that the date format could potentially miss-match the locale as requested using the <b>-z</b> flag. For example, if <i>sqsh</i> is run on an operating system configured for US English, but requests French as the language of choice using <b>-z</b>, the use of <b>$datetime</b> will cause all date information to be displayed in US English rather than French.</p>

<p>Ordinary characters defined in the variable are left in place without any conversion. Characters introduced by a &#39;%&#39; character are replaced during display of a column value according to the definitions in the <b>strftime</b> manual page.</p>

<dl>

<dt id="pod8">[]</dt>
<dd>

<p>Any contained between a pair of braces (&#39;[&#39; and &#39;]&#39;) will be removed when displaying SMALLDATETIME columns. This feature is particularly useful for removing the seconds, milliseconds or microseconds values which are not applicable to SMALLDATETIME anyway. For DATETIME or BIGDATETIME columns, only the actual braces will be removed.</p>

</dd>
<dt id="q">%q</dt>
<dd>

<p>Specifies the milliseconds for DATETIME and TIME and microseconds for BIGDATETIME and BIGTIME data types. In previous versions of sqsh the <i>%u</i> specifier was used for the millisecond part of the datetime datatype. However, as <i>%u</i> is used by <b>strftime</b> to denote the day number of the week, this is replaced by <i>%q</i> since sqsh-2.3. For example when using the default C locale:</p>

<pre><code>    1&gt; \set datetime=&#39;%e %b %Y %H:%M[:%S.%q]%p&#39;
    1&gt; select convert(bigdatetime,getdate())
    2&gt; select convert(smalldatetime,getdate())
    3&gt; go

    -----------------------------
    22 Jul 2013 13:26:52.938000PM
    -------------------
    22 Jul 2013 13:27PM</code></pre>

</dd>
</dl>

</dd>
<dt id="debug-string">debug (string)</dt>
<dd>

<p>If <i>sqsh</i> has been compiled with debugging enabled (-DDEBUG), this variable may be used to control the amount of debugging output displayed. <b>$debug</b> may be set to a pipe (|) delimited (logical OR) set of the following words to turn on various pieces of debugging: <b>ALIAS</b>, <b>AVL</b>, <b>BCP</b>, <b>DISPLAY</b>, <b>ENV</b>, <b>ERROR</b>, <b>EXPAND</b>, <b>FD</b>, <b>HISTORY</b> (abbr. <b>HIST</b>), <b>JOB</b>, <b>READLINE</b> (abbr. <b>RL</b>), <b>RPC</b>, <b>SCREEN</b>, <b>SIG</b>, <b>SIGCHLD</b> (or <b>SIGCLD</b>), <b>TDS</b> or <b>ALL</b>. Can also be set through the <i>-l</i> startup option.</p>

</dd>
<dt id="debug_tds_capture-string">debug_tds_capture (string)</dt>
<dd>

<p>When <b>TDS</b> debugging is enabled and this variable is defined with a valid file name, a debugging trace will be logged into this file that can be analyzed with Ribo. You might need the devlib versions of the OpenClient library to link with sqsh to be able to use this option. See for more information the ct_debug function in the Sybase SDK documentation.</p>

</dd>
<dt id="debug_tds_logdata-string">debug_tds_logdata (string)</dt>
<dd>

<p>When <b>TDS</b> debugging is enabled and this variable is defined with a valid filename, a debugging log will be written by OpenClient with all possible debugging info (CS_DBG_ALL). See also option above.</p>

</dd>
<dt id="defer_bg-boolean">defer_bg (boolean)</dt>
<dd>

<p>Normally, when a job is run in the background (via a &#39;&amp;&#39; on the command line), the output of the job is deferred to a temporary file (located in <i>$tmp_dir</i>) until the user requests the output to be displayed using <b>\show jobid</b>. This way the results of the job will not interfere with what the user is doing. Setting this variable to false will result in no deferred output files being created and output sent to the screen immediately</p>

</dd>
<dt id="echo-boolean">echo (boolean)</dt>
<dd>

<p>Setting <b>$echo</b> to on (1) causes each command submitted to the database via the <b>\go</b> command to be displayed prior to the output. This variable defaults to 0 (or off), and may also be set using the <b>-e</b> command line option.</p>

</dd>
<dt id="encryption-boolean">encryption (boolean)</dt>
<dd>

<p>Setting the <b>$encryption</b> variable prior to establishing a connection to the server will cause the login connection to be initiated using client-side password encryption. This variable may also be set using the <b>-X</b> command line option. Client-side password encryption will also occur when using the <b>-X</b> option on the <b>\connect</b>, <b>\reconnect</b> or <b>\bcp</b> commands. Please note that the Sybase ASE setting for the <b>net password encryption reqd</b> (15.0.2) configuration parameter may enforce you to use client side password encryption. <i>sqsh-2.1.9</i> supports RSA password encryption when the CT-Lib version in use supports it. RSA password encryption is required if the above mentioned ASE configuration parameter is set to <b>2</b>. Older version of sqsh only supports a value of <b>1</b> (CT-Lib internal encryption algorithms).</p>

</dd>
<dt id="exit_failcount-boolean">exit_failcount (boolean)</dt>
<dd>

<p>Settings this value to 1 causes <i>sqsh</i> to return an exit status of <b>$batch_failcount</b> rather than 0, upon a non-error termination. See <b>EXIT STATUS</b> for details. The default value is 0.</p>

</dd>
<dt id="exit_value-int">exit_value (int)</dt>
<dd>

<p>When you exit sqsh by specifying an exit code, like <b>\exit 3</b> or using one of the aliases <b>exit</b> or <b>quit</b> commands, then this value is assigned to the <b>$exit_value</b> variable. You can also assign a value using the <b>\set</b> command. When sqsh determines this variable has a non-zero value during termination, this value will be used as exit code. See <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="expand-boolean">expand (boolean)</dt>
<dd>

<p>By default when the <b>\go</b> command is executed, the contents of the current work buffer is expanded of all environment variables prior to being sent to the database for execution. By setting this variable to &quot;0&quot;, the buffer will no longer be expanded before being sent to the database. This is useful when you either (1) have strings in the buffer that contain a &#39;$&#39; and you don&#39;t want them to be expanded, or (2) for performance reasons; it takes time (and an extra copy of the buffer) to perform the variable expansion.</p>

</dd>
<dt id="filter-boolean">filter (boolean)</dt>
<dd>

<p>Toggles filtering of the SQL batch through an external program (defined by the <b>$filter_prog</b> variable, below) prior to being sent to the SQL Server. Default is &#39;0&#39;, or &#39;off&#39;.</p>

</dd>
<dt id="filter_prog-string">filter_prog (string)</dt>
<dd>

<p>Defines the external program through which the SQL batch will be filtered prior to being sent to the SQL Server. This variable is ignored if <b>$filter</b> is set to &#39;0&#39; or &#39;off&#39;. The default is &#39;m4 -&#39;.</p>

</dd>
<dt id="float-float-format">float (float-format)</dt>
<dd>

<p>Defines the display format (the precision and scale) for all floating point values displayed by sqsh. The default is &#39;18.6&#39;. Note that values exceeding the defined precision are not truncated, so setting this value too low may cause columns in a result set to be miss-aligned.</p>

</dd>
<dt id="footers-boolean">footers (boolean)</dt>
<dd>

<p>Toggles the &quot;(%d rows affected)&quot; following a result set. The default for this variable is &#39;1&#39;.</p>

</dd>
<dt id="headers-boolean">headers (boolean)</dt>
<dd>

<p>Toggles the column headers preceding a result set. The default for this variable is &#39;1&#39;.</p>

</dd>
<dt id="help_dir-path">help_dir (path)</dt>
<dd>

<p>This is the location of the help files used by the <b>\help</b> command, typically it defaults to something like /usr/local/lib/sqsh/help.</p>

</dd>
<dt id="hist_auto_save-int">hist_auto_save (int)</dt>
<dd>

<p>When variable <b>$histsave</b> is on and the <b>$hist_auto_save</b> variable has a value greater than 0, then the history will be automatically saved to <b>$history</b> after <b>$hist_auto_save</b> modifications of the history buffers. When the value is 0 (default), then no automatic history save will be performed.</p>

</dd>
<dt id="histmerge-boolean">histmerge (boolean)</dt>
<dd>

<p>When this option is on, sqsh will merge the contents of the history on disk with the history in memory before writing the history back to disk. This is to prevent data loss in the history file when other sqsh sessions have also written to the same history file on disk. This option is off by default which will just overwrite the existing history file when you exit sqsh or the history is being automatically saved because of <b>$hist_auto_save</b> being set.</p>

</dd>
<dt id="histnum-int">histnum (int)</dt>
<dd>

<p>Contains the history number that will be assigned to the current command batch as soon as the <b>\go</b> command is executed. This variable should be considered read-only. See also the discussion on the <b>$histunique</b> variable.</p>

</dd>
<dt id="history-path">history (path)</dt>
<dd>

<p>This is the location of the history file used to store and retrieve a user&#39;s history during start-up and shutdown. This defaults to <i>$HOME/.sqsh_history</i>. This variable is expanded each time it is referenced by sqsh, much in the same way that <b>$prompt</b> is referenced each time the prompt is displayed.</p>

</dd>
<dt id="history_shorthand-boolean">history_shorthand (boolean)</dt>
<dd>

<p>This variable is only meaningful within an interactive session. If set, it turns on the ability to append any named buffer or history buffer onto the current work buffer in a &#39;sh&#39; history style, such as &#39;!40&#39;. Be careful with this feature, <i>sqsh</i> is not terribly intelligent with looking for history shorthand, so it is possible that it may get confused (although, it is smart enough to ignore !&#39;s in quoted strings).</p>

</dd>
<dt id="histsave-boolean">histsave (boolean)</dt>
<dd>

<p>The value of this variable is used by <i>sqsh</i> to indicate whether the history should be saved to <b>$history</b> prior to termination of sqsh.</p>

</dd>
<dt id="histsize-int">histsize (int)</dt>
<dd>

<p>The value of this variable is used to alter the maximum number of history entries are maintained by <i>sqsh</i> (the default is 10). Note that decreasing the value of this variable causes some history entries to be lost.</p>

</dd>
<dt id="histunique-boolean">histunique (boolean)</dt>
<dd>

<p>If set, <i>sqsh</i> maintains a MRU-LRU order of executed buffers and does not store duplicate command buffers. For example, observe the following situation:</p>

<pre><code>    LINUX1502.user1.master.1&gt; \history
    (1) sp_who
    (2) grant role mon_role to sa_role
    (3) select * from monProcessActivity
    (4) select @@authmech,show_sec_services()
    (5) select @@servername,@@authmech,show_sec_services()
    LINUX1502.user1.master.1&gt; sp_who
    LINUX1502.user1.master.2&gt; go
    ... output omitted
    LINUX1502.user1.master.1&gt; \history
    (1) grant role mon_role to sa_role
    (2) select * from monProcessActivity
    (3) select @@authmech,show_sec_services()
    (4) select @@servername,@@authmech,show_sec_services()
    (5) sp_who</code></pre>

<p><i>sp_who</i> is the last executed command and the buffer - originally the last in the list - is now on top of the list. When an already existing buffer is reused, the value of the <b>$histnum</b> variable is not changed.</p>

</dd>
<dt id="hostname-string">hostname (string)</dt>
<dd>

<p>Used during the connection process to indicate to SQL Server the name of the host from which <i>sqsh</i> is connecting. This variable may also be set using the <b>-H</b> flag.</p>

</dd>
<dt id="ifs-string">ifs (string)</dt>
<dd>

<p>The list of Internal Field Separators.</p>

</dd>
<dt id="ignoreeof-boolean">ignoreeof (boolean)</dt>
<dd>

<p>By default, <i>sqsh</i> terminates if the user presses ^d (control-D) on an empty line and readline support is compiled in. If <b>$ignoreeof</b> is set in the sqshrc file you get a warning message instead:</p>

<pre><code>    CTRL-D: Use &quot;exit&quot; or &quot;quit&quot; to leave the sqsh shell.</code></pre>

<p>This is equivalent to using &quot;set -o ignoreeof&quot; in the bash shell.</p>

</dd>
<dt id="interactive-boolean">interactive (boolean)</dt>
<dd>

<p>This is a variable used internally and should probably not be altered by the user. If <b>$interactive</b> is &#39;0&#39;, then the prompt is not displayed, the history is neither read nor written and some user messages are suppressed.</p>

</dd>
<dt id="interfaces-path">interfaces (path)</dt>
<dd>

<p>This is the full path name of the interfaces file, it defaults to <i>$SYBASE/interfaces</i>.</p>

</dd>
<dt id="keytab_file-string">keytab_file (string)</dt>
<dd>

<p>Used in Kerberos and DCE user authentication security mechanisms. Corresponds with the <b>-K</b> startup option.</p>

<p>See also the discussion on Kerberos Support.</p>

</dd>
<dt id="keyword_completion-int-string">keyword_completion (int/string)</dt>
<dd>

<p>This variable only applies if GNU Readline support has been compiled into <i>sqsh</i>. <b>$keyword_completion</b> is used to control the T-SQL keyword completion feature in readline, and may be set using either an integer between 0 and 4, or one of the strings <i>none</i>, <i>lower</i>, <i>upper</i>, <i>smart</i>, or <i>exact</i>. If it is set to either 0 or <i>none</i>, then no keyword completion is performed (this is the default). <i>lower</i> or 1, causes <i>sqsh</i> to complete the keyword in lowercase, regardless of the case that the partially completed keyword was typed. <i>upper</i> or 2 forces completion to be performed in upper case, <i>smart</i>, or 3, bases the decision on case upon the first character of the partial keyword, and <i>exact</i> completes the keyword in exactly the same case as defined in the <i>.sqsh_words</i> (for the built-in T-SQL keywords, this will be lower case). New in <i>sqsh-2.5</i> is that when regular Readline completion does not match the typed string with a keyword, then filename completion will be tried in the current directory. For example:</p>

<pre><code>    SYBASE.sa.master.1&gt; \lcd $SYBASE/$SYBASE_ASE/scripts
    \lcd: local directory changed to: /opt/sybase/ASE-15_0/scripts
    SYBASE.sa.master.1&gt; \run -n -i ./instm&lt;TAB&gt;</code></pre>

<p>results in the completed filename &quot;./instmsgs.ebf&quot;.</p>

</dd>
<dt id="keyword_dynamic-boolean">keyword_dynamic (boolean)</dt>
<dd>

<p>This variable controls the dynamic loading of keywords in the completion list when initially logging in to the server or when the database context is changed using the <i>use database</i> command. When this variable is set to &#39;On&#39; (default is &#39;Off&#39;), then the query that is provided through the <b>$keyword_query</b> variable is executed and the query result set is loaded into the Readline completion list. This will only work for Sybase ASE and Microsoft SQL servers. This variable also controls dynamic loading of a column list to be auto- completed by Readline. When an object name is followed by a dot and TAB completion is requested, <i>sqsh</i> dynamically creates a list of columns that belongs to the object (table, view, procedure) and allows for Readline TAB completion of the column or parameter names. This feature is only available if GNU Readline support has been compiled into <i>sqsh</i> and <b>$keyword_completion</b> is set to a value greater than zero. In sqsh-2.4 it is also possible to use the object alias in the SQL buffer for auto-completion. For example when you enter the following query in the buffer and type the TAB key twice after the alias &#39;d&#39; and the dot, a list of column names will be produced for the &#39;sysdatabases&#39; table for further completion:</p>

<pre><code>    SYBPROD.sa.tempdb.1&gt; select * from master..sysdatabases d,
    SYBPROD.sa.tempdb.2&gt;               master.dbo.sysusages u
    SYBPROD.sa.tempdb.3&gt; where d.&lt;TAB&gt;&lt;TAB&gt;
    d.audflags         d.def_remote_loc   d.durability       d.status2
    d.audflags2        d.def_remote_type  d.logptr           d.status3
    d.crdate           d.deftabaud        d.name             d.status4
    d.dbid             d.defvwaud         d.spare            d.suid
    d.defpraud         d.dumptrdate       d.status           d.version
    SYBPROD.sa.tempdb.3&gt; where d.</code></pre>

<p>This works both for the T-SQL join syntax and the ANSI inner, outer, left and right join syntax. Note that sqsh is now able to perform cross database auto-completion as well.</p>

</dd>
<dt id="keyword_file-string">keyword_file (string)</dt>
<dd>

<p>If Readline support has been compiled into <i>sqsh</i>, and <i>sqsh</i> is being run in interactive mode, the contents of this file are used for keyword tab completion by Readline rather than the default set of T-SQL syntactical keywords. The default is <i>$HOME/.sqsh_words</i>. When <b>$keyword_dynamic</b> is enabled this takes precedence and overrules the list loaded from <b>$keyword_file</b>.</p>

</dd>
<dt id="keyword_query-string">keyword_query (string)</dt>
<dd>

<p>This variable contains the query that will be executed when a change of database is detected or during initial login (Msg 5701). The default query is:</p>

<pre><code>    select name from sysobjects order by name</code></pre>

<p>But you can supply a different query that suits your needs even better. E.g.</p>

<pre><code>    \set keyword_query=&quot;\\
      select name from sysobjects \\
      where type in (&#39;U&#39;,&#39;V&#39;,&#39;P&#39;,&#39;S&#39;) \\
      union \\
      select name from sybsystemprocs..sysobjects \\
      where type=&#39;P&#39; \\
      order by name&quot;</code></pre>

<p>This feature is controlled by the variables <b>$keyword_completion</b> and <b>$keyword_dynamic</b> and is only available if GNU Readline support has been compiled into <i>sqsh</i>.</p>

</dd>
<dt id="language-string">language (string)</dt>
<dd>

<p>The <b>$language</b> variable is used while establishing a connection to the server to specify the national language used to display system prompts and messages. The variable will automatically track the current language setting of the server. This may also be set via the <b>-z</b> flag.</p>

</dd>
<dt id="lineno-int">lineno (int)</dt>
<dd>

<p>This is an internal variable and should not be altered by the user. It is used to maintain the line number that is being typed into within the current work buffer.</p>

</dd>
<dt id="linesep-string">linesep (string)</dt>
<dd>

<p>Used to configure the line separator for the horizontal display style, this defaults to &quot;\n\t&quot;.</p>

</dd>
<dt id="localeconv-boolean">localeconv (boolean)</dt>
<dd>

<p>A boolean variable that when set to true will result in the Operating System locale to be used for displaying all datetime (DATETIME, SMALLDATETIME, TIME, DATE, BIGDATETIME and BIGTIME) and the numeric, decimal, real, float and money/smallmoney datatypes in the result set. When this variable is set to false (i.e. the default), sqsh will use the internal C/POSIX locale to determine how to display these datatypes. For example:</p>

<pre><code>    ~$ export LANG=nl_NL.utf8
    ~$ locale -ck LC_TIME
    LC_TIME
    abday=&quot;zo;ma;di;wo;do;vr;za&quot;
    day=&quot;zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag&quot;
    abmon=&quot;jan;feb;mrt;apr;mei;jun;jul;aug;sep;okt;nov;dec&quot;
    mon=&quot;januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;
         november;december&quot;
    am_pm=&quot;;&quot;
    ...

    ~$ sqsh -Llocaleconv=On -Ldatetime=&quot;%A %e %B %Y&quot; -C&quot;select getdate()&quot;
     ---------------------------
            maandag 22 juli 2013

    (1 row affected)
    ~$ sqsh -Llocaleconv=Off -Ldatetime=&quot;%A %e %B %Y&quot; -C&quot;select getdate()&quot;
     ---------------------------
             Monday 22 July 2013

    (1 row affected)</code></pre>

<p>Also, depending on the locale, the decimal specifier in money, numeric, decimal, float and real datatypes may be displayed as a <b>&quot;,&quot;</b>. Note that sqsh does not take the thousands_sep into account when displaying numerical data values.</p>

</dd>
<dt id="lock-string-write-only">lock (string/write-only)</dt>
<dd>

<p>Defines the password to be used by the <b>\lock</b> command. If unset or set to the string &quot;NULL&quot;, then the UNIX password of the user running <i>sqsh</i> is used instead (if possible). Note that <b>$lock</b> will always expand to the string &quot;*lock*&quot; if referenced.</p>

</dd>
<dt id="login_timeout-int">login_timeout (int)</dt>
<dd>

<p>The number of seconds to wait when attempting to create a new connection to a data server. Default is 0 (infinite wait). See also the <b>-T</b> command line option.</p>

</dd>
<dt id="max_timeout-int">max_timeout (int)</dt>
<dd>

<p>Controls the number of times a query needs to reach its time-out value before the session is aborted. See <b>$query_timeout</b> and the <b>-Q</b> command line flag. The following messages will be displayed and sqsh exits with value 255 when the <b>$max_timeout</b> limit is reached.</p>

<pre><code>    Query or command timeout detected, session aborted
    The client connection has detected this x time(s)
    Aborting on max_timeout limit</code></pre>

</dd>
<dt id="maxlen-int">maxlen (int)</dt>
<dd>

<p>Controls the maximum amount of data that will be displayed (in any display mode) in a single column. This setting will automatically truncate the output of particularly large data types (such as TEXT) to the value supplied. The default setting is 32768 bytes (32KB).</p>

</dd>
<dt id="newline_go-boolean">newline_go (boolean)</dt>
<dd>

<p>This flag is used as a horrible kludge to support an &quot;empty&quot; alias for the <b>\go</b> command, that is, the equivalent of supplying &quot;-c &#39;&#39;&quot; or just &quot;-c&quot; on the command line. When on, an empty line is interpreted as a call to the <b>\go</b> command. This feature is not recommended but is supplied for completeness.</p>

</dd>
<dt id="nosepline-boolean">nosepline (boolean)</dt>
<dd>

<p>Suppress the separator lines with the pretty output style.</p>

</dd>
<dt id="output_parms-boolean">output_parms (boolean)</dt>
<dd>

<p>Flag used to enable or disable the display of output parameter result sets from stored procedures. The default is to enable the display.</p>

</dd>
<dt id="p2faxm-int">p2faxm (int)</dt>
<dd>

<p>Implements the feature Print messages to File (P2F). This variable is used in conjuction with <b>$p2fname</b> and specifies a threshold on the number of messages per batch that will be send to the terminal window. If the threshold is exceeded, the remaining messages will be send to the specified file. The default value is NULL which disables the P2F feature. Also an assigned value of 0 disables this feature. This feature will only work in interactive mode and is to prevent an accidental flood of server messages scrolling over the screen. For example:</p>

<pre><code>    SYBASE.sa.tempdb.1&gt; \set p2fname=/tmp/sqsh_p2f.out
    SYBASE.sa.tempdb.1&gt; \set p2faxm=10
    SYBASE.sa.tempdb.1&gt; create clustered index keys_cx on keys(id)
    SYBASE.sa.tempdb.2&gt;   with ignore_dup_row
    SYBASE.sa.tempdb.2&gt; go
    Warning: deleted duplicate row.  Primary key is &#39;0&#39;
    Warning: deleted duplicate row.  Primary key is &#39;1&#39;
    Warning: deleted duplicate row.  Primary key is &#39;2&#39;
    Warning: deleted duplicate row.  Primary key is &#39;3&#39;
    Warning: deleted duplicate row.  Primary key is &#39;4&#39;
    Warning: deleted duplicate row.  Primary key is &#39;5&#39;
    Warning: deleted duplicate row.  Primary key is &#39;6&#39;
    Warning: deleted duplicate row.  Primary key is &#39;7&#39;
    Warning: deleted duplicate row.  Primary key is &#39;8&#39;
    Warning: deleted duplicate row.  Primary key is &#39;9&#39;
    Warning: Number of printed server messages exceeds p2faxm=10 limit for current batch.
             Remaining server messages will be printed to file: /tmp/sqsh_p2f.out</code></pre>

</dd>
<dt id="p2fname-path">p2fname (path)</dt>
<dd>

<p>Contains the filename for the Print messages to File (P2F) feature described above. Default is NULL which disables the P2F feature. If a file is specified that already exists, then new data will be appended.</p>

</dd>
<dt id="packet_size-int">packet_size (int)</dt>
<dd>

<p>Defines the size of the TDS packets used to communicate with SQL. Changing the value of the variable will not affect the current connection but will take effect upon the next <b>\reconnect</b> command. Specifying a value of NULL indicates that the default packet size is desired.</p>

</dd>
<dt id="password-string-write-only">password (string/write-only)</dt>
<dd>

<p>This is the user&#39;s current password. A NULL password may be assigned using an explicit &quot;NULL&quot; string. For security reasons, when referenced the <b>$password</b> variable will always expand to the string &quot;*password*&quot;.</p>

</dd>
<dt id="password_retry-boolean">password_retry (boolean)</dt>
<dd>

<p>When the variable is on and sqsh started in interactive mode, sqsh will ask for the password again if login failed. When set to &#39;off&#39;, sqsh will terminate immediately. Default is on.</p>

</dd>
<dt id="principal-string">principal (string)</dt>
<dd>

<p>Used in Kerberos user authentication as the Server principal name when it differs from the <b>$DSQUERY</b> name. Corresponds with the <b>-R</b> startup option.</p>

<p>See also the discussion on Kerberos Support.</p>

</dd>
<dt id="prompt-string">prompt (string)</dt>
<dd>

<p>This variable is used by <i>sqsh</i> to build your current prompt. Any variables contained within <b>$prompt</b> are expanded each time the prompt is displayed. The default value for this is &#39;${lineno}&gt; &#39;. See also the discussion on color support below.</p>

</dd>
<dt id="prompt2-string">prompt2 (string)</dt>
<dd>

<p>This contents of this prompt are expanded and displayed during interactive use when <i>sqsh</i> requires additional input, such as during a line continuation. The default value is &#39;--&gt; &#39;.</p>

</dd>
<dt id="query_timeout-int">query_timeout (int)</dt>
<dd>

<p>Number of seconds to wait for a query to return data. If the timeout is reached the query is aborted (canceled). See also <b>$max_timeout</b> and the <b>-Q</b> command line option.</p>

</dd>
<dt id="rcfile-path">rcfile (path)</dt>
<dd>

<p>Contains a colon (:) delimited list of sqsh resource (sqshrc) files. The default setting is /usr/local/etc/sqshrc (unless overridden by the --prefix option when sqsh was compiled) followed by <i>$HOME/.sqshrc</i>).</p>

</dd>
<dt id="readline_histignore-string">readline_histignore (string)</dt>
<dd>

<p>If readline support has been compiled into <i>sqsh</i>, you can control which commands or statements on the command line will be filtered from the readline history file specified by <b>$readline_history</b>. It is a colon (:) separated string or a string containing a regular expression that is identified by &quot;RE:&quot;. For example:</p>

<pre><code>    \set readline_histignore=&#39;go:lo:mo:exit:quit:vi:!!:GO&#39;
    or
    \set readline_histignore=&#39;&quot;RE:^[glm]o$|^cd |^exit$|^quit$|^vi$&quot;&#39;</code></pre>

<p>The regular expression in the second example starts with <i>RE:</i> and it is recommended to supply the string between quotes and double quotes to prevent expansion and display problems due to the pipe characters. The regular expression is evaluated case insensitive.</p>

</dd>
<dt id="readline_history-string">readline_history (string)</dt>
<dd>

<p>If readline support has been compiled into <i>sqsh</i>, the contents of the readline line-by-line history will be written to the file specified by the <b>$readline_history</b> variable. The default is <i>$HOME/.sqsh_readline</i>.</p>

</dd>
<dt id="readline_histsize-int">readline_histsize (int)</dt>
<dd>

<p>If readline support has been compiled into <i>sqsh</i>, the value of <b>$readline_histsize</b> specifies the number of lines that are saved in the readline line-by-line history. Setting this to a value of 0 causes every line to be saved. The default value is 100.</p>

</dd>
<dt id="real-float-format">real (float-format)</dt>
<dd>

<p>Defines the display format (the precision and scale) for all real values displayed by sqsh. The default is &#39;18.6&#39;. Note that values exceeding the defined precision are not truncated, so setting this value too low may cause columns in a result set to be miss-aligned.</p>

</dd>
<dt id="repeat_batch-boolean">repeat_batch (boolean)</dt>
<dd>

<p>When set to <b>On</b> or <b>True</b>, a <b>\go</b> executed with an empty <b>SQL Buffer</b> will cause the previous batch to be re-executed.</p>

</dd>
<dt id="secmech-string">secmech (string)</dt>
<dd>

<p>The name of the security mechanism used for user authentication. For instance csfkrb5. When using the <b>-Z</b> option, the name of the security mechanism can be specified, or when no secmech is supplied, the OpenClient will use the default, i.e. the first security entry from the <i>$SYBASE/$SYBASE_OCS/config/libtcl.cfg</i> file. Note that the name used must match the name of the corresponding secmech entry in the <i>objectid.dat</i> file. When the connection to the server is setup, the actual secmech name will be stored in the <b>$secmech</b> variable.</p>

</dd>
<dt id="secure_options-string">secure_options (string)</dt>
<dd>

<p>Describe the security options used for user authentication security mechanisms. Corresponds to the <b>-V</b> startup option.</p>

<p>See also the paragraph on Kerberos Support.</p>

</dd>
<dt id="script-string">script (string)</dt>
<dd>

<p>If <i>sqsh</i> is run using the <b>-i</b> flag, then this variable contains the name of the script being executed.</p>

</dd>
<dt id="semicolon_cmd-string">semicolon_cmd (string)</dt>
<dd>

<p>When <b>$semicolon_hack</b> (see below) is enabled, the contents of this variable is executed when a semicolon is encountered in the <b>SQL Buffer</b>. This variable defaults to the string &#39;<b>\go</b>&#39;.</p>

</dd>
<dt id="semicolon_hack-boolean">semicolon_hack (boolean)</dt>
<dd>

<p>Toggles on the ability to use a &#39;;&#39; as an in-line command terminator. This feature is not recommended and is only in here because enough users complained. See section <b>COMMANDS, In-Line \go</b>.</p>

</dd>
<dt id="semicolon_hack2-boolean">semicolon_hack2 (boolean)</dt>
<dd>

<p>Toggles on the ability to use multiple &#39;;&#39; as an in-line command terminator. See section <b>COMMANDS, In-Line \go</b>.</p>

</dd>
<dt id="session-string">session (string)</dt>
<dd>

<p>The location of the session file that will be processed just before connecting to a server. The variable will be expanded so it may contain environment variables.</p>

</dd>
<dt id="SHELL-string">SHELL (string)</dt>
<dd>

<p>The name of the shell to be used to execute pipes and to be used by the <b>\shell</b> command (default &#39;/bin/sh&#39;).</p>

</dd>
<dt id="statistics-boolean">statistics (boolean)</dt>
<dd>

<p>Setting <b>$statistics</b> to 1 causes timing statistics to be displayed upon the successful execution of every batch of SQL. This variable may also be set via the <b>-p</b> command line flag, or by supplying <b>-p</b> to the <b>\go</b> command. <b>$statistics</b> defaults to 0.</p>

</dd>
<dt id="style-string">style (string)</dt>
<dd>

<p>Selects result set display style. Currently eight styles are supported. The <b>horiz</b> (which may also be defined as <b>hor</b> or <b>horizontal</b>), closely resembles the output of isql, with the traditional columnar output.</p>

<p>The <b>vert</b> (or <b>vertical</b>) style rotates the output, so that every line is represented by a column name followed by a column value. This is nice for looking at particularly wide output.</p>

<p>The <b>bcp</b> style displays results in a format amenable to bcp&#39;ing the result set back into another table. That is, every column value is separated by <b>$bcp_colsep</b> with the final column separated by <b>$bcp_rowsep</b> followed by a newline (\n). If <b>$bcp_colsep</b> or <b>$bcp_rowsep</b> are not defined then &#39;|&#39; is used as the default separator. Note that this output does not work well with COMPUTE columns, and uses the default conversion methods for all data types (that is, <b>datetime</b> columns may truncate the millisecond).</p>

<p>The <b>csv</b> display style outputs all result sets in the form of a comma separated construct. This mode is ideal to import result sets into spreadsheet programs, for instance.</p>

<p>The <b>html</b> display style outputs all result sets in the form of an HTML &lt;TABLE&gt; construct. This mode is ideal for the use of sqsh as a CGI application.</p>

<p>The <b>meta</b> display style outputs only the meta-data information associated with the result and discards the actual row results. This mode is useful for debugging the result sets generated from a full passthru Open Server gateway, or for those interested in what is really coming back from the server.</p>

<p>The <b>pretty</b> display style generates a fluffy table-like output using regular ASCII characters for borders. This mode does not perform any explicit column wrapping, like the <b>horiz</b> display mode. However, the <b>$colwidth</b> variable can be used to control the maximum width of a given column on the screen. If the column exceeds <b>$colwidth</b> characters wide, it is wrapped in a relatively visually appealing manner. Note that <b>$colwidth</b> may be exceeded if there is enough screen width to hold the columns without wrapping.</p>

<p>The <b>none</b> display style suppresses all results from being displayed (however it does actually retrieve result information from the SQL Server). This is particularly useful when used with the <b>-p</b> flag (or the <b>$statistics</b> variable) for gathering accurate performance statistics.</p>

</dd>
<dt id="term_title-string">term_title (string)</dt>
<dd>

<p>When this variable is set, sqsh will reset the name of the current terminal (xterm) window it is running in. Works for xterm, rxvt, putty and MS-Windows CMD windows. The name consists of the sqsh startup name appended with the expanded value of the <b>$term_title</b> variable.</p>

</dd>
<dt id="thresh_display-int">thresh_display (int)</dt>
<dd>

<p>Sets the minimum SQL Server error severity that will display a message to the user, the default is 0 and valid ranges are between 0 and 22, inclusive.</p>

</dd>
<dt id="thresh_exit-int">thresh_exit (int)</dt>
<dd>

<p>Defines the maximum number of errors of severity level <b>$thresh_fail</b> that may be encountered before sqsh aborts. This is useful primarily for non-interactive scripts, but is allowed on an interactive session. Setting <b>$thresh_exit</b> to a value of 0 disables this feature. See section <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="thresh_fail-int">thresh_fail (int)</dt>
<dd>

<p>Sets the minimum SQL Server severity level that is to be considered a failed batch. The minimum for this value is 0 (meaning any error that is not an information message), and the maximum is 22. Whenever <b>$thresh_fail</b> is crossed, the variable <b>$batch_failcount</b> is incremented by 1. See section <b>EXIT STATUS</b> for details.</p>

</dd>
<dt id="time-date-spec">time (date-spec)</dt>
<dd>

<p>This variable may be set with a time format (see the man page for <b>date(1)</b>), and the variable expands to the current time in the supplied format. The default format for this variable is %H:%M:%S (e.g. 14:32:58).</p>

</dd>
<dt id="timefmt-date-spec">timefmt (date-spec)</dt>
<dd>

<p>This variable may be set with a time format similar to <b>$time</b> and is used to control the display format of all SQL Server TIME and BIGTIME columns. (Similar to <b>$datetime</b>.) Note that only 63 bytes are available in total for the expanded string and the remainder will be truncated.</p>

</dd>
<dt id="tmp_dir-path">tmp_dir (path)</dt>
<dd>

<p>This contains the directory to which temporary files used internally by <i>sqsh</i> are to be written. These files are generated either during buffer editing (the <b>\buf-edit</b> command), or to maintain output defer files for background jobs. The default value for this variable is /tmp.</p>

</dd>
<dt id="usedbcheck-boolean">usedbcheck (boolean)</dt>
<dd>

<p>When this variable is set to &#39;On&#39; (default is &#39;Off&#39;) and a database name is provided with the -D parameter and sqsh is run in batch mode, i.e. non-interactive, then a check will be performed if the specified database is accessible, otherwise sqsh is aborted with exit code 254. Also the following error message will be shown:</p>

<p><b>sqsh: ERROR: Unable to use database &#39;...&#39; in batch mode</b></p>

<p>This is to prevent that a SQL script is inadvertently executed in the wrong database, usually the default database of the login (master for example).</p>

</dd>
<dt id="username-string">username (string)</dt>
<dd>

<p>The name of the user currently connected to the database.</p>

</dd>
<dt id="version-none">version (none)</dt>
<dd>

<p>This read-only variable contains the current version number. (sqsh-2.1.7)</p>

</dd>
<dt id="width-int">width (int)</dt>
<dd>

<p>The current width of the SQL output.</p>

</dd>
<dt id="xgeom-string-int">xgeom (string/int)</dt>
<dd>

<p>If X11 support is compiled into <i>sqsh</i>, this value is used to configure the default window size (in characters) of the X display. This variable must be of the format <b>WxH</b> or just <b>W</b>, where <b>W</b> is the width of the window and <b>H</b> is the height of the window. If the height of the window is not supplied, then 25 lines is assumed. If <b>$xgeom</b> is not set, then <b>$width</b> is used as the default width and the height is assumed to be 25. If neither is set, then 80x25 is assumed.</p>

</dd>
<dt id="xwin_title-string">xwin_title (string)</dt>
<dd>

<p>If X11 support is compiled into <i>sqsh</i> and an X11 result windows is requested by using the <b>-x</b> parameter of the <i>\go</i> or <i>\rpc</i> commands, then this variable will be used to set the title name of the window. Can be temporarily overridden with the <b>-T</b> option of the <i>\go</i> and <i>\rpc</i> commands.</p>

</dd>
</dl>

<h2 id="Script-Execution">Script Execution</h2>

<p>As with most shells, <i>sqsh</i> allows a file containing SQL and script commands to be executed directly via the magical UNIX <b>#!</b> convention. On most UNIX platforms, when the operating system encounters the bytes <b>#!</b> as the first two bytes of an executable file it will automatically pipe the file through the interpreter specified immediately after the <b>#!</b>. For example, to create an executable <i>sqsh</i> script to run <b>sp_who</b>, you simply need to create a file like so:</p>

<pre><code>    #!/usr/local/bin/sqsh -i
    sp_who
    go</code></pre>

<p>Thus, if your <b>sp_who</b> script is executed directly, it will automatically launch &quot;<b>/usr/local/bin/sqsh -i sp_who</b>&quot; for you.</p>

<p>And, to make things even more flexible, <i>sqsh</i> supports positional parameters, similar to most shells, of the form <b>${n}</b> which will expand to the <b>n</b>th argument to your <i>sqsh</i> script. For example:</p>

<pre><code>    #!/usr/local/bin/sqsh -i
    sp_who ${1}
    go</code></pre>

<p>will cause the <b>sp_who</b> stored procedure to be executed with an argument of the first command line parameter supplied to the <b>sp_who</b> shell script.</p>

<p>Note that positional parameters <i>must</i> be contained between braces to avoid conflicts with the T-SQL <b>money</b> data type (without the braces, the variable will not be expanded).</p>

<h1 id="EXIT-STATUS">EXIT STATUS</h1>

<p>One of the major complaints of <i>isql</i> is that it provides no facility to detect when an error condition occurred while it is performing processing. <i>sqsh</i> provides a rather complex, but flexible mechanism for returning meaningful information concerning its reason for exit in the form of an exit status (see <b>exit(3)</b>).</p>

<p>When <i>sqsh</i> begins execution two handlers are associated with the current connection to the database, one is a message handler which is responsible for displaying the text of any SQL Server messages or errors, and the other is an error handler, which is responsible for determining what to do with an error condition (bear with me, these are only loose descriptions). And, associated with each message and error condition is a severity level, between 0 and 22 (informational message to fatal condition).</p>

<p>Associated with these two message handlers are several variables that are used to either control their behavior, or are used as indicators by the message handler:</p>

<dl>

<dt id="thresh_display">$thresh_display</dt>
<dd>

<p>This variable is used by the message handler to determine the minimum error severity which will cause a message to be displayed. By default this is 0, which will display all messages (with a couple of exceptions). Setting this to 1, for example, would suppress informational messages such as the output of <b>set showplan on</b>.</p>

</dd>
<dt id="thresh_fail">$thresh_fail</dt>
<dd>

<p>This variable is used by the error handler to determine which error severity is considered by <i>sqsh</i> to be a failure. Normally, this defaults to 11 which indicates that any error, other than informational messages, is a failure. The next variable will explain the importance of this value.</p>

</dd>
<dt id="batch_failcount">$batch_failcount</dt>
<dd>

<p>This variable should be considered read-only, and contains the total number of times that batches have caused an error of severity <b>$thresh_fail</b> or more. The only value that is valid to explicitly set this value to, is &quot;&quot; (the empty string), which will reset this value to 0, any other value may have unpredictable results.</p>

</dd>
<dt id="thresh_exit">$thresh_exit</dt>
<dd>

<p>This variable is used to determine the limit at which <b>$batch_failcount</b> will cause <i>sqsh</i> to exit. If <b>$thresh_exit</b> is 0, then this feature is disabled. In other words, if <b>$batch_failcount = $thresh_exit</b> and <b>$thresh_exit</b> is greater than 0, then <i>sqsh</i> will exit, returning <b>$batch_failcount</b> as an exit status.</p>

<p>Note that, unless <b>$exit_failcount</b> is set to 1, <i>sqsh</i> will exit with 0 if the total number of failures does not reach <b>$thresh_exit</b>.</p>

</dd>
<dt id="exit_failcount">$exit_failcount</dt>
<dd>

<p>This variable is used only when <i>sqsh</i> would normally exit with a success status (0), this causes it to instead exit with a value of <b>$batch_failcount</b> (which may, itself, be 0).</p>

</dd>
<dt id="exit_value">$exit_value</dt>
<dd>

<p>When this variable is non-zero, it will override the <b>$exit_failcount</b> and <b>$batch_failcount</b> values and just exit the value of <b>$exit_value</b>. This variable may be explicitly set using the <b>\set</b> command, or implicitly using <b>\exit x</b> and its aliased counterparts.</p>

</dd>
</dl>

<p>To recap, here is a list of error codes that may be returned by <i>sqsh</i> upon exit, and the reason that they could be returned:</p>

<dl>

<dt id="pod--0">- 0 -</dt>
<dd>

<p>No error has been encountered.</p>

</dd>
<dt id="pod--1...253">- 1...253 -</dt>
<dd>

<p>Between 1 and 253 batches have failed (if you run more than 253 batches, the exit status of sqsh is undetermined...I may fix this in the future).</p>

</dd>
<dt id="pod--254">- 254 -</dt>
<dd>

<p>An explicit <b>\abort</b> was called, or a SIGINT (^C) was issued during a non-interactive session.</p>

</dd>
<dt id="pod--255">- 255 -</dt>
<dd>

<p>A general error condition has occurred, such as a bad command line argument to sqsh, memory allocation failure, file access error, etc.</p>

</dd>
</dl>

<p>The following sections provide detailed examples of combinations of variable settings and the results produced upon exit with certain failure conditions. It is assumed the <b>$exit_value</b> variable contains 0 in the next examples.</p>

<dl>

<dt id="thresh_display-0-thresh_fail-0-thresh_exit-1">thresh_display=0, thresh_fail=0, thresh_exit=1</dt>
<dd>

<p>With this combination, all error messages will be displayed as they happen, and every error will be considered an failure condition. Upon reaching the first error, <i>sqsh</i> will abort with an exit status of 1, or the total number of failures (the <b>$batch_failcount</b> variable). However, if nothing goes wrong during the whole process, a zero is returned.</p>

</dd>
<dt id="thresh_display-0-thresh_fail-0-thresh_exit-3">thresh_display=0, thresh_fail=0, thresh_exit=3</dt>
<dd>

<p>This combination will cause all error conditions to be displayed and all of them to be considered a failure condition. Upon reaching three total failed batches, <i>sqsh</i> will exit with a status of 3. However if 0, 1, or 2 batches fail, then 0 is returned.</p>

</dd>
<dt id="thresh_display-22-thresh_fail-0-thresh_exit-3">thresh_display=22, thresh_fail=0, thresh_exit=3</dt>
<dd>

<p>This behaves the same as the previous example, with the exception that all error messages will be suppressed from being displayed. This is particularly useful if you just care about the exit value more than the actual error.</p>

</dd>
<dt id="thresh_display-0-thresh_fail-2-thresh_exit-1">thresh_display=0, thresh_fail=2, thresh_exit=1</dt>
<dd>

<p>This will cause the first error of severity 2 or higher to be displayed and cause <i>sqsh</i> to exit with a failure condition of 1.</p>

</dd>
<dt id="thresh_display-0-thresh_fail-0-thresh_exit-3-exit_failcount-1">thresh_display=0, thresh_fail=0, thresh_exit=3, exit_failcount=1</dt>
<dd>

<p>This is identical to the second example, above, however <b>sqsh</b> will return the total number of batches that failed even if <b>$batch_failcount</b> does not reach 3.</p>

</dd>
<dt id="exit_value-nonzero">exit_value=nonzero</dt>
<dd>

<p>This will override all conditions explained above and just exit the specific value.</p>

</dd>
</dl>

<h1 id="MISCELLANEOUS">MISCELLANEOUS</h1>

<h2 id="Colorizing-sqsh-prompts">Colorizing sqsh prompts</h2>

<p>Color codes are presented as a string like {1;2;3}. If sqsh encounters a { (curly brace) in the prompt string it will assume a color-code is supplied and will act as such. No checks will be performed on the validity of the color-code definition itself. The color definition consists of three values separated by a semicolon.</p>

<p>The first code defines the Color Attribute Code with possible values: 0=none 1=bold The second value defines the Text Color Code: 30=black 31=red 32=green 33=yellow 34=blue 35=magenta 36=cyan 37=white The third value defines the Background Color Code: 40=black 41=red 42=green 43=yellow 44=blue 45=magenta 46=cyan 47=white The last color-code for the background may be omitted. Not all color and attribute combinations will present good results, depending on your terminal type and color scheme. But the following values work OK on a xterm with a creamy white background color in Linux as well as rxvt in Cygwin with a black background window:</p>

<pre><code>    Prompt: Blue text in white background &quot;{0;34;47}&quot;
    Command text: Yellow text             &quot;{0;33}&quot;
    Command text: Default text color      &quot;{0}&quot;</code></pre>

<p>sqsh will translate the color-codes to an actual color-code string that is presented to readline: for example &quot;\001\033[0;36;47m\002&quot;. Note that if you want to use curly brackets in your prompt, you have to escape colorization by specifying a double brace, like {{...}}. For example:</p>

<pre><code>    \set prompt_color=&#39;{0;34;47}&#39;
    \set text_color=&#39;{0}&#39;
    \set prompt=&#39;$prompt_color{{$DSQUERY.$username.$database.$lineno}}&gt;$text_color &#39;</code></pre>

<p>Color support is automatically available if sqsh is compiled and linked with readline support enabled.</p>

<h1 id="FILES">FILES</h1>

<p>Defaults: $HOME/.sqshrc, $HOME/.sqsh_session, $HOME/.sqsh_history, $HOME/.sqsh_readline, $HOME/.sqsh_words, $tmp_dir/sqsh-dfr.*, $tmp_dir/sqsh-edit.* These can all be modified using the internal <i>sqsh</i> variables described above.</p>

<h1 id="BUGS">BUGS</h1>

<p>The addition of flow-of-control expressions has extended sqsh <i>way</i> beyond the scope of its original design, and it is quite obvious from using the features they are hacked in and are rather clunky (although still quite usable). As a result, the processing of these expressions is rather slow (when compared to bourne shell), and the error reporting doesn&#39;t lend itself to debugging large scripts. The development of 1000+ line scripts is discouraged.</p>

<p>The combination of backgrounding and pipes does not work properly right now. What happens is, when a background job is run that incorporates a pipe-line, <i>sqsh</i> will suspend until the job is complete, which is obviously not what you desire. To test this, try the following:</p>

<pre><code>    1&gt; select * from syscolumns
    2&gt; go | grep id &amp;</code></pre>

<p>You will find that you do not get your prompt back until the job completes. The same is more ore less true for pipes being used with the \do command:</p>

<pre><code>    1&gt; select name from master..sysdatabases
    2&gt; \do | grep syb</code></pre>

<p>This will not give you a prompt anymore until the block completes with \done. So you are typing the do block itself in the dark and there is no possiblity to edit a do block or retrieve a do block from the history list. So you may have typed (hopefully without syntax errors):</p>

<pre><code>    \echo #1
    \done</code></pre>

<p>After \done is processed the results will be displayed followed by a fresh prompt.</p>

<p>Please report any other bugs to http://sourceforge.net/p/sqsh/bugs Feature requests may be posted to http://sourceforge.net/p/sqsh/feature-requests</p>


</body>

</html>


